{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Colony Documentation","text":"<p>Welcome to the Colony project documentation. Colony is a modern personal expense management application built with FastAPI and Next.js.</p>"},{"location":"#what-is-colony","title":"What is Colony?","text":"<p>Colony is a full-stack web application designed to help you track and manage your personal expenses efficiently. It provides a clean, intuitive interface for recording expenses, categorizing them, and gaining insights into your spending patterns.</p> <p>Whether you're looking to get better control of your finances or exploring modern web development technologies, Colony offers a practical solution built with industry-standard tools.</p>"},{"location":"#quick-navigation","title":"Quick Navigation","text":"<ul> <li> <p>\ud83d\ude80 Getting Started</p> <p>Set up Colony for development or production use</p> </li> <li> <p>\ud83c\udfd7\ufe0f Architecture</p> <p>Understand the system design and technical structure</p> </li> <li> <p>\ud83d\udce1 API Reference</p> <p>Complete backend API documentation and endpoints</p> </li> <li> <p>\ud83d\udc64 User Guide</p> <p>Learn how to use Colony's features effectively</p> </li> <li> <p>\ud83d\udee0\ufe0f Development</p> <p>Contributing guidelines and development setup</p> </li> <li> <p>\ud83d\uddfa\ufe0f Roadmap</p> <p>See what's planned for future releases</p> </li> </ul>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>\ud83d\udcca Expense Tracking - Record and categorize your expenses with ease</li> <li>\ud83d\udcc8 Analytics - Visualize your spending patterns and trends</li> <li>\ud83d\udcb3 Multi-Account Support - Manage expenses across different accounts</li> <li>\ud83d\udd12 Secure - Protected with authentication and authorization</li> <li>\ud83d\udcf1 Responsive - Works seamlessly on desktop, tablet, and mobile</li> <li>\ud83c\udf19 Modern UI - Clean interface built with NextUI components</li> </ul>"},{"location":"#technology-stack","title":"Technology Stack","text":"<p>Colony is built using modern, industry-standard technologies:</p> Component Technology Purpose Backend FastAPI with Python RESTful API and business logic Frontend Next.js with NextUI Responsive user interface Documentation MkDocs Material Project documentation Containerization Docker &amp; Docker Compose Development and deployment"},{"location":"#project-status","title":"Project Status","text":"<p>Development Status</p> <p>Colony is currently in active development. This documentation will be updated as new features are implemented. Check the roadmap for planned features and timeline.</p>"},{"location":"#getting-help","title":"Getting Help","text":"<ul> <li>\ud83d\udcd6 Documentation: You're in the right place! Browse the sections above</li> <li>\ud83d\ude80 Quick Start: New to Colony? Check out Getting Started</li> <li>\ud83d\udc1b Issues: Found a bug? Report it on GitHub Issues</li> <li>\ud83d\udca1 Feature Requests: Have an idea? Open a feature request on GitHub</li> </ul>"},{"location":"#about-this-project","title":"About This Project","text":"<p>Colony serves multiple purposes:</p> <ul> <li>Personal Finance Management: A robust tool for tracking personal expenses</li> <li>Technology Practice: Exploration of modern web development technologies</li> <li>Learning Experience: Implementation of best practices in full-stack development</li> </ul> <p>This project demonstrates real-world application development using contemporary tools and methodologies, making it both a practical expense tracker and a learning resource.</p> <p>Ready to get started? Head over to our Getting Started guide!</p>"},{"location":"requirements/","title":"Software Requirements Specification","text":""},{"location":"requirements/#1-introduction","title":"1. Introduction","text":""},{"location":"requirements/#11-purpose","title":"1.1 Purpose","text":"<p>This document specifies the functional and non-functional requirements for Colony, a personal expense management application designed to replace Excel-based expense tracking with automated cycle management.</p>"},{"location":"requirements/#12-scope","title":"1.2 Scope","text":"<p>Colony will provide users with the ability to:</p> <ul> <li>Track expenses across multiple currencies (USD, MXN)</li> <li>Manage recurring expenses with various patterns</li> <li>Create expense cycles (6-week periods)</li> <li>Automatically generate expenses for new cycles</li> <li>Categorize expenses (Fixed, Variable)</li> <li>Track payment methods and account balances</li> <li>Generate financial summaries and projections by location and type</li> </ul>"},{"location":"requirements/#13-current-workflow","title":"1.3 Current Workflow","text":"<p>The system replaces a manual Excel-based process where users:</p> <ul> <li>Track expenses every 6 weeks (3 pay cycles of bi-weekly payments)</li> <li>Copy and modify recurring expenses for new periods</li> <li>Manage expenses in USD and MXN currencies</li> <li>Categorize expenses by type (Fixed/Variable) and implicitly by location via currency</li> <li>Generate payment summaries by account/card</li> </ul>"},{"location":"requirements/#2-overall-description","title":"2. Overall Description","text":""},{"location":"requirements/#21-product-perspective","title":"2.1 Product Perspective","text":"<p>Colony is a standalone web application consisting of:</p> <ul> <li>A RESTful API backend (FastAPI) with multi-currency support</li> <li>A responsive web frontend (Next.js) with cycle management</li> <li>A containerized deployment solution</li> </ul>"},{"location":"requirements/#22-user-classes","title":"2.2 User Classes","text":"<ul> <li>Primary User: Individual managing personal expenses across multiple currencies and accounts</li> <li>Administrator: System maintainer (for self-hosted instances)</li> </ul>"},{"location":"requirements/#3-functional-requirements","title":"3. Functional Requirements","text":""},{"location":"requirements/#31-user-authentication","title":"3.1 User Authentication","text":"<ul> <li>FR-001: Users must be able to create an account</li> <li>FR-002: Users must be able to log in securely</li> <li>FR-003: Users must be able to reset their password</li> </ul>"},{"location":"requirements/#32-currency-management","title":"3.2 Currency Management","text":"<ul> <li>FR-004: System must support multiple currencies (USD, MXN)</li> <li>FR-005: System must track exchange rates for currency conversion</li> <li>FR-006: System must convert expenses to base currency (USD) for reporting</li> </ul>"},{"location":"requirements/#33-payment-method-management","title":"3.3 Payment Method Management","text":"<ul> <li>FR-007: Users must be able to create custom payment methods with the following attributes:<ul> <li>Name (e.g., \"Chase Debit\", \"Chase Credit\", \"Capital Credit\", \"Mexico Cash\")</li> <li>Type (Debit, Credit, Cash, Transfer)</li> <li>Default currency (USD or MXN)</li> <li>Active/Inactive status</li> </ul> </li> <li>FR-008: Users must be able to edit existing payment methods</li> <li>FR-009: Users must be able to deactivate payment methods (soft delete to preserve historical data)</li> <li>FR-010: Users must be able to assign descriptive names to payment methods</li> <li>FR-011: Users must be able to specify payment method type (debit, credit, cash, transfer)</li> <li>FR-012: Users must be able to set a default currency for each payment method</li> <li>FR-013: System must prevent deletion of payment methods that are used in existing expenses</li> <li>FR-014: Users must be able to deactivate payment methods to hide them from new expense creation</li> <li>FR-015: System must provide default payment method templates for common use cases</li> <li>FR-016: System must validate that payment method and currency combinations are logical</li> <li>FR-017: Users must be able to view all payment methods (active and inactive)</li> </ul>"},{"location":"requirements/#34-expense-template-management","title":"3.4 Expense Template Management","text":"<ul> <li>FR-018: Users must be able to create expense templates with the following fields:<ul> <li>Description</li> <li>Currency (USD/MXN)</li> <li>Payment Method</li> <li>Amount</li> <li>Category (Fixed/Variable)</li> <li>Recurrence Pattern</li> <li>Auto-pay details (optional)</li> <li>Status</li> <li>Comments</li> </ul> </li> <li>FR-019: System must support recurrence patterns:<ul> <li>Weekly: Specific day of week (every Saturday)</li> <li>Bi-weekly: Every 14 days from start date</li> <li>Monthly: Same date each month</li> <li>Custom: User-defined intervals</li> </ul> </li> <li>FR-020: Users must be able to edit expense templates</li> <li>FR-021: Users must be able to delete expense templates</li> <li>FR-022: Users must be able to view all expense templates</li> <li>FR-023: Each expense must specify currency and payment method</li> </ul>"},{"location":"requirements/#35-cycle-management","title":"3.5 Cycle Management","text":"<ul> <li>FR-024: Users must be able to create expense cycles (6-week periods)</li> <li>FR-025: System must automatically generate expenses for new cycles based on templates</li> <li>FR-026: Users must be able to modify generated expenses within a cycle</li> <li>FR-027: Users must be able to set \"Remaining Balance\" for each cycle</li> <li>FR-028: System must track cycle periods with start and end dates</li> <li>FR-029: Users must be able to view cycle history</li> </ul>"},{"location":"requirements/#36-expense-management-within-cycles","title":"3.6 Expense Management Within Cycles","text":"<ul> <li>FR-030: Users must be able to manually add expenses to a cycle</li> <li>FR-031: Users must be able to edit cycle expenses</li> <li>FR-032: Users must be able to delete cycle expenses</li> <li>FR-033: Users must be able to mark expenses as paid/unpaid</li> <li>FR-034: System must calculate dates based on recurrence patterns and cycle start date</li> </ul>"},{"location":"requirements/#37-expense-categorization","title":"3.7 Expense Categorization","text":"<ul> <li>FR-035: System must categorize expenses as:<ul> <li>Fixed Expenses</li> <li>Variable Expenses</li> </ul> </li> <li>FR-036: System must determine expense location based on currency:<ul> <li>USD expenses = USA-based expenses</li> <li>MXN expenses = Mexico-based expenses</li> </ul> </li> <li>FR-037: Users must be able to manually override expense categories</li> <li>FR-038: System must provide category rules based on payment method and description patterns</li> </ul>"},{"location":"requirements/#38-financial-reporting-and-analytics","title":"3.8 Financial Reporting and Analytics","text":"<ul> <li>FR-039: System must generate cycle summaries showing:<ul> <li>Income for the period</li> <li>Fixed expenses total</li> <li>Variable expenses total</li> <li>Mexico expenses total (MXN currency expenses converted to USD)</li> <li>USA expenses total (USD currency expenses)</li> <li>Net balance (Income - Total Expenses)</li> </ul> </li> <li>FR-040: System must generate payment method summaries showing:<ul> <li>Amount needed per payment method</li> <li>Amount paid per payment method</li> <li>Amount pending per payment method</li> </ul> </li> <li>FR-041: System must calculate projected balances:<ul> <li>\"Before Paying\"</li> <li>\"After Paying\"</li> </ul> </li> <li>FR-042: Users must be able to view multi-period summaries (combining multiple cycles)</li> <li>FR-043: System must support period-over-period comparisons</li> <li>FR-044: System must provide expense breakdowns by:<ul> <li>Category (Fixed vs Variable)</li> <li>Location (USA vs Mexico based on currency)</li> <li>Payment Method</li> <li>Time period</li> </ul> </li> </ul>"},{"location":"requirements/#39-data-importexport","title":"3.9 Data Import/Export","text":"<ul> <li>FR-045: Users must be able to import existing expense data from Excel/CSV</li> <li>FR-046: Users must be able to export cycle data to Excel/CSV</li> <li>FR-047: System must support bulk expense template creation</li> </ul>"},{"location":"requirements/#4-non-functional-requirements","title":"4. Non-Functional Requirements","text":""},{"location":"requirements/#41-performance","title":"4.1 Performance","text":"<ul> <li>NFR-001: Cycle generation must complete within 5 seconds for 50+ expense templates</li> <li>NFR-002: Currency conversion must be real-time or cached for same-day accuracy</li> <li>NFR-003: Financial reports must generate within 3 seconds</li> </ul>"},{"location":"requirements/#42-security","title":"4.2 Security","text":"<ul> <li>NFR-004: All financial data must be encrypted at rest</li> <li>NFR-005: All API endpoints must be authenticated</li> <li>NFR-006: Passwords must be securely hashed</li> <li>NFR-007: Data transmission must be encrypted (HTTPS)</li> </ul>"},{"location":"requirements/#43-usability","title":"4.3 Usability","text":"<ul> <li>NFR-008: Interface must be responsive across devices</li> <li>NFR-009: Currency amounts must display with proper formatting ($1,234.56)</li> <li>NFR-010: Date selection must be intuitive for cycle creation</li> <li>NFR-011: Bulk operations (cycle generation) must show progress indicators</li> </ul>"},{"location":"requirements/#44-reliability","title":"4.4 Reliability","text":"<ul> <li>NFR-012: System must handle currency conversion failures gracefully</li> <li>NFR-013: Data must be automatically backed up</li> <li>NFR-014: System must prevent duplicate expense generation in cycles</li> </ul>"},{"location":"requirements/#45-internationalization","title":"4.5 Internationalization","text":"<ul> <li>NFR-015: Interface must support English and Spanish languages</li> <li>NFR-016: Currency formatting must respect locale (USD vs MXN display)</li> <li>NFR-017: Date formats must be configurable</li> </ul>"},{"location":"requirements/#5-technical-constraints","title":"5. Technical Constraints","text":"<ul> <li>Must use FastAPI for backend API</li> <li>Must use Next.js for frontend</li> <li>Must be containerizable with Docker</li> <li>Must work in modern web browsers</li> <li>Must support SQLite for development and PostgreSQL for production</li> <li>Must integrate with currency exchange rate APIs</li> </ul>"},{"location":"requirements/#6-data-requirements","title":"6. Data Requirements","text":""},{"location":"requirements/#61-expense-template-schema","title":"6.1 Expense Template Schema","text":"<pre><code>- id: UUID\n- description: String (required)\n- currency: Enum (USD, MXN)\n- payment_method: String (required)\n- base_amount: Decimal\n- recurrence_type: Enum (weekly, monthly, custom)\n- recurrence_config: JSON (day_of_week, day_of_month, interval)\n- autopay_info: String (optional)\n- category: Enum (fixed, variable)\n- active: Boolean\n- created_at: DateTime\n- updated_at: DateTime\n- user_id: UUID (FK)\n</code></pre>"},{"location":"requirements/#62-cycle-schema","title":"6.2 Cycle Schema","text":"<pre><code>- id: UUID\n- start_date: Date\n- end_date: Date\n- remaining_balance: Decimal\n- income_amount: Decimal\n- status: Enum (active, completed, draft)\n- created_at: DateTime\n- user_id: UUID (FK)\n</code></pre>"},{"location":"requirements/#63-cycle-expense-schema","title":"6.3 Cycle Expense Schema","text":"<pre><code>- id: UUID\n- cycle_id: UUID (FK)\n- template_id: UUID (FK, optional)\n- description: String\n- currency: Enum (USD, MXN)\n- payment_method: String\n- amount: Decimal\n- amount_usd: Decimal (calculated)\n- date: Date\n- autopay_info: String\n- status: String\n- comments: String\n- category: Enum (fixed, variable)\n- paid: Boolean\n- created_at: DateTime\n</code></pre>"},{"location":"requirements/#64-payment-method-schema","title":"6.4 Payment Method Schema","text":"<pre><code>- id: UUID\n- name: String (user-defined, e.g., \"Chase Debit\", \"Capital One Credit\")\n- type: Enum (debit, credit, cash, transfer)\n- default_currency: Enum (USD, MXN)\n- description: String (optional, for user notes)\n- active: Boolean\n- created_at: DateTime\n- updated_at: DateTime\n- user_id: UUID (FK)\n</code></pre>"},{"location":"requirements/#7-integration-requirements","title":"7. Integration Requirements","text":""},{"location":"requirements/#71-currency-exchange","title":"7.1 Currency Exchange","text":"<ul> <li>IR-001: System must integrate with currency exchange API (e.g., Exchange Rates API)</li> <li>IR-002: Exchange rates must be cached and updated daily</li> <li>IR-003: Historical exchange rates must be stored for accurate reporting</li> </ul>"},{"location":"requirements/#72-future-integrations-nice-to-have","title":"7.2 Future Integrations (Nice to Have)","text":"<ul> <li>IR-004: Bank account integration for automatic expense importing</li> <li>IR-005: Mobile app notifications for upcoming expenses</li> <li>IR-006: Email reports for cycle summaries</li> </ul>"},{"location":"roadmap/","title":"Project Roadmap","text":"<p>This roadmap outlines the planned development phases for Colony.</p>"},{"location":"roadmap/#phase-1-foundation","title":"Phase 1: Foundation \u2705","text":"<ul> <li>[x] Setup basic project structure</li> <li>[x] Create comprehensive documentation</li> <li>[ ] Implement authentication system</li> <li>[ ] Setup CI/CD pipeline</li> </ul>"},{"location":"roadmap/#phase-2-core-features","title":"Phase 2: Core Features \ud83d\udea7","text":"<ul> <li>[ ] Create expense CRUD operations</li> <li>[ ] Implement category management</li> <li>[ ] Build responsive frontend</li> <li>[ ] Add basic data validation</li> </ul>"},{"location":"roadmap/#phase-3-analytics","title":"Phase 3: Analytics \ud83d\udcc5","text":"<ul> <li>[ ] Add data visualization</li> <li>[ ] Implement spending analytics</li> <li>[ ] Create financial reports</li> <li>[ ] Add filtering and search</li> </ul>"},{"location":"roadmap/#phase-4-advanced-features","title":"Phase 4: Advanced Features \ud83d\udd2e","text":"<ul> <li>[ ] Multi-account support</li> <li>[ ] Data export capabilities</li> <li>[ ] Mobile app (React Native)</li> <li>[ ] Advanced reporting</li> </ul>"},{"location":"roadmap/#phase-5-polish","title":"Phase 5: Polish \ud83d\udcab","text":"<ul> <li>[ ] Performance optimization</li> <li>[ ] Enhanced UI/UX</li> <li>[ ] Comprehensive testing</li> <li>[ ] Security audit</li> </ul> <p>Legend: - \u2705 Completed - \ud83d\udea7 In Progress - \ud83d\udcc5 Planned - \ud83d\udd2e Future Consideration - \ud83d\udcab Polish Phase</p>"},{"location":"architecture/api-specification/","title":"Colony API Specification","text":"<p>DOCUMENTATION STATUS</p> <p>This document is used for initial architecture design and planning of the Colony API endpoints. Once the FastAPI implementation begins, this documentation will be deprecated in favor of the auto-generated OpenAPI/Swagger documentation available at:</p> <ul> <li>Development: <code>http://localhost:8000/docs</code> (Swagger UI)</li> <li>Development: <code>http://localhost:8000/redoc</code> (ReDoc)</li> <li>Production: <code>https://api.colony.app/docs</code></li> </ul> <p>The purpose of this document is to: - Define the overall API structure and endpoints - Establish request/response schemas - Guide initial development priorities - Serve as a reference during the design phase</p> <p>For current API documentation, always refer to the auto-generated FastAPI docs.</p> <p>This document defines the REST API endpoints for the Colony expense management application.</p>"},{"location":"architecture/api-specification/#api-overview","title":"API Overview","text":"<ul> <li>Base URL: <code>https://api.colony.app/v1</code></li> <li>Authentication: Bearer token (JWT)</li> <li>Content-Type: <code>application/json</code></li> <li>API Version: v1</li> </ul>"},{"location":"architecture/api-specification/#authentication","title":"Authentication","text":"<p>All endpoints require authentication except for user registration and login.</p> <pre><code>Authorization: Bearer &lt;jwt_token&gt;\n</code></pre>"},{"location":"architecture/api-specification/#response-format","title":"Response Format","text":""},{"location":"architecture/api-specification/#success-responses","title":"Success Responses","text":"<p>API endpoints return data directly without wrapper objects. HTTP status codes indicate success or failure.</p>"},{"location":"architecture/api-specification/#error-responses","title":"Error Responses","text":"<p>All errors follow a consistent format: <pre><code>{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"ERROR_CODE\",\n    \"message\": \"Human readable error message\",\n    \"details\": {\n      // Additional error details if applicable\n    }\n  }\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#api-endpoints","title":"API Endpoints","text":""},{"location":"architecture/api-specification/#1-authentication-users","title":"1. Authentication &amp; Users","text":""},{"location":"architecture/api-specification/#post-authregister","title":"POST /auth/register","text":"<p>Register a new user account.</p> <p>Request Body: <pre><code>{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"preferred_currency\": \"USD\",\n  \"locale\": \"en-US\"\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n  \"email\": \"user@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"preferred_currency\": \"USD\",\n  \"locale\": \"en-US\",\n  \"active\": true,\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#post-authlogin","title":"POST /auth/login","text":"<p>Authenticate user and get access token.</p> <p>Request Body (Form Data): <pre><code>username=user@example.com\npassword=securePassword123\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n  \"token_type\": \"bearer\",\n  \"expires_in\": 1800\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#get-authme","title":"GET /auth/me","text":"<p>Get current user information.</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n  \"email\": \"user@example.com\",\n  \"first_name\": \"John\",\n  \"last_name\": \"Doe\",\n  \"preferred_currency\": \"USD\",\n  \"locale\": \"en-US\",\n  \"active\": true,\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#put-authme","title":"PUT /auth/me","text":"<p>Update current user information.</p> <p>Request Body: <pre><code>{\n  \"first_name\": \"John Updated\",\n  \"last_name\": \"Doe Updated\",\n  \"preferred_currency\": \"MXN\",\n  \"locale\": \"es-MX\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n  \"email\": \"user@example.com\",\n  \"first_name\": \"John Updated\",\n  \"last_name\": \"Doe Updated\",\n  \"preferred_currency\": \"MXN\",\n  \"locale\": \"es-MX\",\n  \"active\": true,\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T12:30:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#put-authmepassword","title":"PUT /auth/me/password","text":"<p>Update current user password.</p> <p>Request Body: <pre><code>{\n  \"current_password\": \"oldPassword123\",\n  \"new_password\": \"newSecurePassword456\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"message\": \"Password updated successfully\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#2-payment-methods","title":"2. Payment Methods","text":""},{"location":"architecture/api-specification/#get-payment-methods","title":"GET /payment-methods","text":"<p>Get all user's payment methods.</p> <p>Query Parameters: - <code>active</code> (boolean, optional): Filter by active status - <code>currency</code> (string, optional): Filter by default currency</p> <p>Response: <code>200 OK</code> <pre><code>[\n  {\n    \"id\": \"123e4567-e89b-12d3-a456-426614174001\",\n    \"name\": \"Chase Debit\",\n    \"method_type\": \"debit\",\n    \"default_currency\": \"USD\",\n    \"description\": \"Primary checking account\",\n    \"active\": true,\n    \"created_at\": \"2025-01-01T00:00:00Z\",\n    \"updated_at\": \"2025-01-01T00:00:00Z\"\n  },\n  {\n    \"id\": \"123e4567-e89b-12d3-a456-426614174002\",\n    \"name\": \"Capital One Credit\",\n    \"method_type\": \"credit\",\n    \"default_currency\": \"USD\",\n    \"description\": \"Rewards credit card\",\n    \"active\": true,\n    \"created_at\": \"2025-01-01T00:00:00Z\",\n    \"updated_at\": \"2025-01-01T00:00:00Z\"\n  }\n]\n</code></pre></p>"},{"location":"architecture/api-specification/#post-payment-methods","title":"POST /payment-methods","text":"<p>Create a new payment method.</p> <p>Request Body: <pre><code>{\n  \"name\": \"Capital One Credit\",\n  \"method_type\": \"credit\",\n  \"default_currency\": \"USD\",\n  \"description\": \"Rewards credit card\"\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174002\",\n  \"name\": \"Capital One Credit\",\n  \"method_type\": \"credit\",\n  \"default_currency\": \"USD\",\n  \"description\": \"Rewards credit card\",\n  \"active\": true,\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#get-payment-methodsid","title":"GET /payment-methods/{id}","text":"<p>Get a specific payment method.</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174001\",\n  \"name\": \"Chase Debit\",\n  \"method_type\": \"debit\",\n  \"default_currency\": \"USD\",\n  \"description\": \"Primary checking account\",\n  \"active\": true,\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#put-payment-methodsid","title":"PUT /payment-methods/{id}","text":"<p>Update an existing payment method.</p> <p>Request Body: <pre><code>{\n  \"name\": \"Chase Debit Updated\",\n  \"description\": \"Updated description\",\n  \"active\": true\n}\n</code></pre></p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174001\",\n  \"name\": \"Chase Debit Updated\",\n  \"method_type\": \"debit\",\n  \"default_currency\": \"USD\",\n  \"description\": \"Updated description\",\n  \"active\": true,\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T12:30:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#delete-payment-methodsid","title":"DELETE /payment-methods/{id}","text":"<p>Deactivate a payment method (soft delete).</p> <p>Response: <code>204 No Content</code></p>"},{"location":"architecture/api-specification/#3-expense-templates","title":"3. Expense Templates","text":""},{"location":"architecture/api-specification/#get-expense-templates","title":"GET /expense-templates","text":"<p>Get all user's expense templates.</p> <p>Query Parameters: - <code>active</code> (boolean, optional): Filter by active status - <code>category</code> (string, optional): Filter by category (fixed/variable) - <code>currency</code> (string, optional): Filter by currency</p> <p>Response: <code>200 OK</code> <pre><code>[\n  {\n    \"id\": \"123e4567-e89b-12d3-a456-426614174003\",\n    \"description\": \"Rent\",\n    \"currency\": \"USD\",\n    \"base_amount\": \"1200.00\",\n    \"category\": \"fixed\",\n    \"recurrence_type\": \"monthly\",\n    \"recurrence_config\": {\n      \"day_of_month\": 1\n    },\n    \"reference_date\": \"2024-12-01\",\n    \"autopay_info\": \"Auto-pay enabled\",\n    \"active\": true,\n    \"payment_method\": {\n      \"id\": \"123e4567-e89b-12d3-a456-426614174001\",\n      \"name\": \"Chase Debit\",\n      \"method_type\": \"debit\"\n    },\n    \"created_at\": \"2025-01-01T00:00:00Z\",\n    \"updated_at\": \"2025-01-01T00:00:00Z\"\n  }\n]\n</code></pre></p>"},{"location":"architecture/api-specification/#post-expense-templates","title":"POST /expense-templates","text":"<p>Create a new expense template.</p> <p>Request Body: <pre><code>{\n  \"description\": \"Groceries\",\n  \"currency\": \"USD\",\n  \"payment_method_id\": \"123e4567-e89b-12d3-a456-426614174001\",\n  \"base_amount\": \"150.00\",\n  \"category\": \"variable\",\n  \"recurrence_type\": \"weekly\",\n  \"recurrence_config\": {\n    \"day_of_week\": 6\n  },\n  \"reference_date\": \"2024-12-21\",\n  \"autopay_info\": null\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174004\",\n  \"description\": \"Groceries\",\n  \"currency\": \"USD\",\n  \"base_amount\": \"150.00\",\n  \"category\": \"variable\",\n  \"recurrence_type\": \"weekly\",\n  \"recurrence_config\": {\n    \"day_of_week\": 6\n  },\n  \"reference_date\": \"2024-12-21\",\n  \"autopay_info\": null,\n  \"active\": true,\n  \"payment_method\": {\n    \"id\": \"123e4567-e89b-12d3-a456-426614174001\",\n    \"name\": \"Chase Debit\",\n    \"method_type\": \"debit\"\n  },\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#get-expense-templatesid","title":"GET /expense-templates/{id}","text":"<p>Get a specific expense template.</p>"},{"location":"architecture/api-specification/#put-expense-templatesid","title":"PUT /expense-templates/{id}","text":"<p>Update an expense template.</p>"},{"location":"architecture/api-specification/#delete-expense-templatesid","title":"DELETE /expense-templates/{id}","text":"<p>Delete an expense template.</p> <p>Response: <code>204 No Content</code></p>"},{"location":"architecture/api-specification/#4-cycles","title":"4. Cycles","text":""},{"location":"architecture/api-specification/#get-cycles","title":"GET /cycles","text":"<p>Get all user's cycles with pagination.</p> <p>Query Parameters: - <code>status</code> (string, optional): Filter by status (draft/active/completed) - <code>page</code> (integer, optional): Page number (default: 1) - <code>per_page</code> (integer, optional): Items per page (default: 20, max: 100)</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"cycles\": [\n    {\n      \"id\": \"123e4567-e89b-12d3-a456-426614174004\",\n      \"name\": \"January 2025 Cycle\",\n      \"start_date\": \"2025-01-01\",\n      \"end_date\": \"2025-02-11\",\n      \"income_amount\": \"5000.00\",\n      \"remaining_balance\": \"500.00\",\n      \"status\": \"active\",\n      \"summary\": {\n        \"total_expenses\": \"4500.00\",\n        \"fixed_expenses\": \"3000.00\",\n        \"variable_expenses\": \"1500.00\",\n        \"expense_count\": 25,\n        \"paid_count\": 10,\n        \"pending_count\": 15\n      },\n      \"created_at\": \"2025-01-01T00:00:00Z\",\n      \"updated_at\": \"2025-01-01T00:00:00Z\"\n    }\n  ],\n  \"pagination\": {\n    \"page\": 1,\n    \"per_page\": 20,\n    \"total\": 1,\n    \"pages\": 1\n  }\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#post-cycles","title":"POST /cycles","text":"<p>Create a new cycle.</p> <p>Request Body: <pre><code>{\n  \"name\": \"February 2025 Cycle\",\n  \"start_date\": \"2025-02-12\",\n  \"end_date\": \"2025-03-25\",\n  \"income_amount\": \"5200.00\",\n  \"remaining_balance\": \"0.00\",\n  \"generate_from_templates\": true\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174005\",\n  \"name\": \"February 2025 Cycle\",\n  \"start_date\": \"2025-02-12\",\n  \"end_date\": \"2025-03-25\",\n  \"income_amount\": \"5200.00\",\n  \"remaining_balance\": \"5200.00\",\n  \"status\": \"draft\",\n  \"summary\": {\n    \"total_expenses\": \"0.00\",\n    \"fixed_expenses\": \"0.00\",\n    \"variable_expenses\": \"0.00\",\n    \"expense_count\": 0,\n    \"paid_count\": 0,\n    \"pending_count\": 0\n  },\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#get-cyclesid","title":"GET /cycles/{id}","text":"<p>Get a specific cycle with detailed information.</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174004\",\n  \"name\": \"January 2025 Cycle\",\n  \"start_date\": \"2025-01-01\",\n  \"end_date\": \"2025-02-11\",\n  \"income_amount\": \"5000.00\",\n  \"remaining_balance\": \"500.00\",\n  \"status\": \"active\",\n  \"summary\": {\n    \"total_expenses\": \"4500.00\",\n    \"fixed_expenses\": \"3000.00\",\n    \"variable_expenses\": \"1500.00\",\n    \"expense_count\": 25,\n    \"paid_count\": 10,\n    \"pending_count\": 15\n  },\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#put-cyclesid","title":"PUT /cycles/{id}","text":"<p>Update a cycle.</p> <p>Request Body: <pre><code>{\n  \"name\": \"January 2025 Cycle Updated\",\n  \"income_amount\": \"5500.00\",\n  \"status\": \"active\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code></p>"},{"location":"architecture/api-specification/#delete-cyclesid","title":"DELETE /cycles/{id}","text":"<p>Delete a cycle and all associated expenses.</p> <p>Response: <code>204 No Content</code></p>"},{"location":"architecture/api-specification/#5-cycle-expenses","title":"5. Cycle Expenses","text":""},{"location":"architecture/api-specification/#get-cyclescycle_idexpenses","title":"GET /cycles/{cycle_id}/expenses","text":"<p>Get all expenses for a specific cycle.</p> <p>Query Parameters: - <code>status</code> (string, optional): Filter by status (pending/paid/cancelled/overdue) - <code>category</code> (string, optional): Filter by category (fixed/variable) - <code>currency</code> (string, optional): Filter by currency - <code>payment_method_id</code> (string, optional): Filter by payment method</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"expenses\": [\n    {\n      \"id\": \"123e4567-e89b-12d3-a456-426614174005\",\n      \"description\": \"Rent\",\n      \"currency\": \"USD\",\n      \"amount\": \"1200.00\",\n      \"amount_usd\": \"1200.00\",\n      \"due_date\": \"2025-01-01\",\n      \"category\": \"fixed\",\n      \"status\": \"paid\",\n      \"paid\": true,\n      \"paid_at\": \"2025-01-01T08:00:00Z\",\n      \"comments\": \"Paid on time\",\n      \"autopay_info\": \"Auto-pay enabled\",\n      \"template_id\": \"123e4567-e89b-12d3-a456-426614174003\",\n      \"payment_method\": {\n        \"id\": \"123e4567-e89b-12d3-a456-426614174001\",\n        \"name\": \"Chase Debit\",\n        \"method_type\": \"debit\"\n      },\n      \"created_at\": \"2025-01-01T00:00:00Z\",\n      \"updated_at\": \"2025-01-01T08:00:00Z\"\n    }\n  ],\n  \"summary\": {\n    \"total_amount_usd\": \"1200.00\",\n    \"fixed_amount\": \"1200.00\",\n    \"variable_amount\": \"0.00\",\n    \"paid_amount\": \"1200.00\",\n    \"pending_amount\": \"0.00\",\n    \"total_count\": 1\n  }\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#post-cyclescycle_idexpenses","title":"POST /cycles/{cycle_id}/expenses","text":"<p>Add a manual expense to a cycle.</p> <p>Request Body: <pre><code>{\n  \"description\": \"Emergency car repair\",\n  \"currency\": \"USD\",\n  \"payment_method_id\": \"123e4567-e89b-12d3-a456-426614174002\",\n  \"amount\": \"350.00\",\n  \"due_date\": \"2025-01-15\",\n  \"category\": \"variable\",\n  \"comments\": \"Unexpected expense\"\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"id\": \"123e4567-e89b-12d3-a456-426614174006\",\n  \"description\": \"Emergency car repair\",\n  \"currency\": \"USD\",\n  \"amount\": \"350.00\",\n  \"amount_usd\": \"350.00\",\n  \"due_date\": \"2025-01-15\",\n  \"category\": \"variable\",\n  \"status\": \"pending\",\n  \"paid\": false,\n  \"paid_at\": null,\n  \"comments\": \"Unexpected expense\",\n  \"autopay_info\": null,\n  \"template_id\": null,\n  \"payment_method\": {\n    \"id\": \"123e4567-e89b-12d3-a456-426614174002\",\n    \"name\": \"Capital One Credit\",\n    \"method_type\": \"credit\"\n  },\n  \"created_at\": \"2025-01-01T00:00:00Z\",\n  \"updated_at\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#get-cyclescycle_idexpensesexpense_id","title":"GET /cycles/{cycle_id}/expenses/{expense_id}","text":"<p>Get a specific expense.</p>"},{"location":"architecture/api-specification/#put-cyclescycle_idexpensesexpense_id","title":"PUT /cycles/{cycle_id}/expenses/{expense_id}","text":"<p>Update an expense.</p> <p>Request Body: <pre><code>{\n  \"amount\": \"375.00\",\n  \"paid\": true,\n  \"paid_at\": \"2025-01-15T14:30:00Z\",\n  \"comments\": \"Updated amount and marked as paid\"\n}\n</code></pre></p> <p>Response: <code>200 OK</code></p>"},{"location":"architecture/api-specification/#delete-cyclescycle_idexpensesexpense_id","title":"DELETE /cycles/{cycle_id}/expenses/{expense_id}","text":"<p>Delete an expense from a cycle.</p> <p>Response: <code>204 No Content</code></p>"},{"location":"architecture/api-specification/#6-reports-analytics","title":"6. Reports &amp; Analytics","text":""},{"location":"architecture/api-specification/#get-cyclescycle_idsummary","title":"GET /cycles/{cycle_id}/summary","text":"<p>Get detailed cycle summary and analytics.</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"cycle\": {\n    \"id\": \"123e4567-e89b-12d3-a456-426614174004\",\n    \"name\": \"January 2025 Cycle\",\n    \"start_date\": \"2025-01-01\",\n    \"end_date\": \"2025-02-11\",\n    \"income_amount\": \"5000.00\"\n  },\n  \"financial\": {\n    \"total_expenses_usd\": \"4500.00\",\n    \"fixed_expenses_usd\": \"3000.00\",\n    \"variable_expenses_usd\": \"1500.00\",\n    \"usa_expenses_usd\": \"3800.00\",\n    \"mexico_expenses_usd\": \"700.00\",\n    \"net_balance\": \"500.00\"\n  },\n  \"by_payment_method\": [\n    {\n      \"payment_method\": {\n        \"id\": \"123e4567-e89b-12d3-a456-426614174001\",\n        \"name\": \"Chase Debit\"\n      },\n      \"total_amount\": \"2500.00\",\n      \"paid_amount\": \"1500.00\",\n      \"pending_amount\": \"1000.00\",\n      \"expense_count\": 15\n    }\n  ],\n  \"by_currency\": {\n    \"USD\": {\n      \"total_amount\": \"3800.00\",\n      \"expense_count\": 20\n    },\n    \"MXN\": {\n      \"total_amount\": \"14000.00\",\n      \"total_amount_usd\": \"700.00\",\n      \"expense_count\": 5\n    }\n  },\n  \"status_breakdown\": {\n    \"pending\": 15,\n    \"paid\": 8,\n    \"overdue\": 2,\n    \"cancelled\": 0\n  }\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#get-reportscycles-comparison","title":"GET /reports/cycles-comparison","text":"<p>Compare multiple cycles.</p> <p>Query Parameters: - <code>cycle_ids</code> (array, required): Comma-separated cycle IDs - <code>metrics</code> (array, optional): Specific metrics to compare</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"cycles\": [\n    {\n      \"cycle\": {\n        \"id\": \"123e4567-e89b-12d3-a456-426614174004\",\n        \"name\": \"January 2025 Cycle\"\n      },\n      \"metrics\": {\n        \"total_expenses\": \"4500.00\",\n        \"fixed_expenses\": \"3000.00\",\n        \"variable_expenses\": \"1500.00\"\n      }\n    }\n  ],\n  \"comparison\": {\n    \"average_total\": \"4500.00\",\n    \"trends\": {\n      \"expenses\": \"stable\"\n    }\n  }\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#7-system-endpoints","title":"7. System Endpoints","text":""},{"location":"architecture/api-specification/#get-enums","title":"GET /enums","text":"<p>Get all system enums for form validation.</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"currency_codes\": [\"USD\", \"MXN\"],\n  \"payment_method_types\": [\"debit\", \"credit\", \"cash\", \"transfer\"],\n  \"expense_categories\": [\"fixed\", \"variable\"],\n  \"recurrence_types\": [\"weekly\", \"bi_weekly\", \"monthly\", \"custom\"],\n  \"cycle_statuses\": [\"draft\", \"active\", \"completed\"],\n  \"expense_statuses\": [\"pending\", \"paid\", \"cancelled\", \"overdue\"]\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#get-exchange-rates","title":"GET /exchange-rates","text":"<p>Get current exchange rates.</p> <p>Query Parameters: - <code>from</code> (string, optional): Source currency - <code>to</code> (string, optional): Target currency - <code>date</code> (string, optional): Specific date (YYYY-MM-DD)</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"rates\": [\n    {\n      \"from_currency\": \"MXN\",\n      \"to_currency\": \"USD\",\n      \"rate\": \"0.050000\",\n      \"rate_date\": \"2025-01-01\"\n    }\n  ]\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#get-health","title":"GET /health","text":"<p>System health check.</p> <p>Response: <code>200 OK</code> <pre><code>{\n  \"status\": \"healthy\",\n  \"service\": \"colony-api\",\n  \"version\": \"1.0.0\",\n  \"timestamp\": \"2025-01-01T00:00:00Z\"\n}\n</code></pre></p>"},{"location":"architecture/api-specification/#error-codes","title":"Error Codes","text":"Code HTTP Status Description <code>VALIDATION_ERROR</code> 400 Request validation failed <code>USER_NOT_FOUND</code> 404 User not found <code>USER_ALREADY_EXISTS</code> 409 User already exists <code>INVALID_CREDENTIALS</code> 401 Invalid email or password <code>INVALID_TOKEN</code> 401 Invalid or expired token <code>INACTIVE_USER</code> 403 User account is inactive <code>INCORRECT_PASSWORD</code> 400 Current password is incorrect <code>RESOURCE_NOT_FOUND</code> 404 Requested resource not found <code>RESOURCE_CONFLICT</code> 409 Resource conflict (e.g., duplicate name) <code>CURRENCY_CONVERSION_ERROR</code> 422 Failed to convert currency <code>CYCLE_GENERATION_ERROR</code> 422 Failed to generate cycle expenses <code>INTERNAL_SERVER_ERROR</code> 500 Server error"},{"location":"architecture/api-specification/#http-status-codes","title":"HTTP Status Codes","text":"<ul> <li><code>200 OK</code> - Successful GET, PUT requests</li> <li><code>201 Created</code> - Successful POST requests (resource created)</li> <li><code>204 No Content</code> - Successful DELETE requests</li> <li><code>400 Bad Request</code> - Invalid request data</li> <li><code>401 Unauthorized</code> - Authentication required or invalid token</li> <li><code>403 Forbidden</code> - Insufficient permissions</li> <li><code>404 Not Found</code> - Resource not found</li> <li><code>409 Conflict</code> - Resource conflict</li> <li><code>422 Unprocessable Entity</code> - Validation error or business logic error</li> <li><code>500 Internal Server Error</code> - Server error</li> </ul>"},{"location":"architecture/api-specification/#rate-limiting","title":"Rate Limiting","text":"<ul> <li>Authenticated requests: 1000 requests per hour</li> <li>Authentication endpoints: 10 requests per minute</li> <li>Report generation: 100 requests per hour</li> </ul>"},{"location":"architecture/api-specification/#data-validation-rules","title":"Data Validation Rules","text":""},{"location":"architecture/api-specification/#currency-amounts","title":"Currency Amounts","text":"<ul> <li>Must be positive decimal numbers</li> <li>Maximum 2 decimal places</li> <li>Maximum value: 999,999,999.99</li> </ul>"},{"location":"architecture/api-specification/#dates","title":"Dates","text":"<ul> <li>Format: YYYY-MM-DD</li> <li>Cycle end_date must be after start_date</li> <li>Reference dates can be in the past</li> </ul>"},{"location":"architecture/api-specification/#text-fields","title":"Text Fields","text":"<ul> <li>Description: 1-255 characters</li> <li>Name: 1-100 characters</li> <li>Comments: 0-1000 characters</li> </ul>"},{"location":"architecture/api-specification/#api-usage-examples","title":"API Usage Examples","text":""},{"location":"architecture/api-specification/#creating-a-complete-expense-cycle","title":"Creating a Complete Expense Cycle","text":"<ol> <li>Create Payment Methods (if not exists)</li> <li>Create Expense Templates</li> <li>Create Cycle with automatic template generation</li> <li>Modify Generated Expenses as needed</li> <li>Track Payment Status throughout the cycle</li> <li>Generate Reports for analysis</li> </ol>"},{"location":"architecture/api-specification/#example-workflow","title":"Example Workflow","text":"<pre><code>// 1. Create payment method\nconst paymentMethodResponse = await fetch('/api/v1/payment-methods', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Authorization': 'Bearer ' + token\n  },\n  body: JSON.stringify({\n    name: 'Chase Debit',\n    method_type: 'debit',\n    default_currency: 'USD'\n  })\n});\nconst paymentMethod = await paymentMethodResponse.json();\n\n// 2. Create expense template\nconst templateResponse = await fetch('/api/v1/expense-templates', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Authorization': 'Bearer ' + token\n  },\n  body: JSON.stringify({\n    description: 'Rent',\n    currency: 'USD',\n    payment_method_id: paymentMethod.id,\n    base_amount: '1200.00',\n    category: 'fixed',\n    recurrence_type: 'monthly',\n    recurrence_config: { day_of_month: 1 },\n    reference_date: '2024-12-01'\n  })\n});\n\n// 3. Create cycle\nconst cycleResponse = await fetch('/api/v1/cycles', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'Authorization': 'Bearer ' + token\n  },\n  body: JSON.stringify({\n    name: 'February 2025 Cycle',\n    start_date: '2025-02-01',\n    end_date: '2025-03-14',\n    income_amount: '5000.00',\n    generate_from_templates: true\n  })\n});\nconst cycle = await cycleResponse.json();\n\n// 4. Get cycle summary\nconst summaryResponse = await fetch(`/api/v1/cycles/${cycle.id}/summary`, {\n  headers: {\n    'Authorization': 'Bearer ' + token\n  }\n});\nconst summary = await summaryResponse.json();\n</code></pre>"},{"location":"architecture/backend/","title":"Backend Architecture","text":"<p>Colony's backend follows a modular, domain-driven architecture using FastAPI with clear separation of concerns and industry best practices.</p>"},{"location":"architecture/backend/#architecture-overview","title":"Architecture Overview","text":"<p>The backend is built using FastAPI with a domain-driven design approach, where each business domain (auth, expenses, cycles, etc.) is organized as a self-contained module with its own models, schemas, services, and routes.</p>"},{"location":"architecture/backend/#key-principles","title":"Key Principles","text":"<ul> <li>Domain-Driven Design: Each business domain is a separate module</li> <li>Separation of Concerns: Clear boundaries between layers (routes, services, data)</li> <li>Dependency Injection: Clean dependency management</li> <li>Type Safety: Full type annotations with Pydantic</li> <li>Testing: Comprehensive test coverage per domain</li> </ul>"},{"location":"architecture/backend/#project-structure","title":"Project Structure","text":"<pre><code>backend/\n\u251c\u2500\u2500 alembic/                    # Database migrations\n\u2502   \u251c\u2500\u2500 versions/\n\u2502   \u2514\u2500\u2500 env.py\n\u251c\u2500\u2500 app/                        # Main application source\n\u2502   \u251c\u2500\u2500 auth/                   # Authentication domain\n\u2502   \u2502   \u251c\u2500\u2500 router.py           # Auth API routes\n\u2502   \u2502   \u251c\u2500\u2500 schemas.py          # Pydantic request/response models\n\u2502   \u2502   \u251c\u2500\u2500 models.py           # SQLAlchemy database models\n\u2502   \u2502   \u251c\u2500\u2500 dependencies.py     # Auth-specific dependencies\n\u2502   \u2502   \u251c\u2500\u2500 service.py          # Authentication business logic\n\u2502   \u2502   \u251c\u2500\u2500 config.py           # Auth configuration (JWT settings)\n\u2502   \u2502   \u251c\u2500\u2500 constants.py        # Auth constants and error codes\n\u2502   \u2502   \u251c\u2500\u2500 exceptions.py       # Auth-specific exceptions\n\u2502   \u2502   \u2514\u2500\u2500 utils.py            # Auth utility functions\n\u2502   \u251c\u2500\u2500 payment_methods/        # Payment methods domain\n\u2502   \u2502   \u251c\u2500\u2500 router.py\n\u2502   \u2502   \u251c\u2500\u2500 schemas.py\n\u2502   \u2502   \u251c\u2500\u2500 models.py\n\u2502   \u2502   \u251c\u2500\u2500 dependencies.py\n\u2502   \u2502   \u251c\u2500\u2500 service.py\n\u2502   \u2502   \u251c\u2500\u2500 constants.py\n\u2502   \u2502   \u251c\u2500\u2500 exceptions.py\n\u2502   \u2502   \u2514\u2500\u2500 utils.py\n\u2502   \u251c\u2500\u2500 expense_templates/      # Expense templates domain\n\u2502   \u2502   \u251c\u2500\u2500 router.py\n\u2502   \u2502   \u251c\u2500\u2500 schemas.py\n\u2502   \u2502   \u251c\u2500\u2500 models.py\n\u2502   \u2502   \u251c\u2500\u2500 dependencies.py\n\u2502   \u2502   \u251c\u2500\u2500 service.py\n\u2502   \u2502   \u251c\u2500\u2500 constants.py\n\u2502   \u2502   \u251c\u2500\u2500 exceptions.py\n\u2502   \u2502   \u2514\u2500\u2500 utils.py\n\u2502   \u251c\u2500\u2500 cycles/                 # Cycle management domain\n\u2502   \u2502   \u251c\u2500\u2500 router.py\n\u2502   \u2502   \u251c\u2500\u2500 schemas.py\n\u2502   \u2502   \u251c\u2500\u2500 models.py\n\u2502   \u2502   \u251c\u2500\u2500 dependencies.py\n\u2502   \u2502   \u251c\u2500\u2500 service.py\n\u2502   \u2502   \u251c\u2500\u2500 constants.py\n\u2502   \u2502   \u251c\u2500\u2500 exceptions.py\n\u2502   \u2502   \u2514\u2500\u2500 utils.py\n\u2502   \u251c\u2500\u2500 expenses/               # Individual expenses domain\n\u2502   \u2502   \u251c\u2500\u2500 router.py\n\u2502   \u2502   \u251c\u2500\u2500 schemas.py\n\u2502   \u2502   \u251c\u2500\u2500 models.py\n\u2502   \u2502   \u251c\u2500\u2500 dependencies.py\n\u2502   \u2502   \u251c\u2500\u2500 service.py\n\u2502   \u2502   \u251c\u2500\u2500 constants.py\n\u2502   \u2502   \u251c\u2500\u2500 exceptions.py\n\u2502   \u2502   \u2514\u2500\u2500 utils.py\n\u2502   \u251c\u2500\u2500 reports/                # Analytics and reporting domain\n\u2502   \u2502   \u251c\u2500\u2500 router.py\n\u2502   \u2502   \u251c\u2500\u2500 schemas.py\n\u2502   \u2502   \u251c\u2500\u2500 service.py\n\u2502   \u2502   \u251c\u2500\u2500 constants.py\n\u2502   \u2502   \u251c\u2500\u2500 exceptions.py\n\u2502   \u2502   \u2514\u2500\u2500 utils.py\n\u2502   \u251c\u2500\u2500 exchange_rates/         # Currency exchange domain\n\u2502   \u2502   \u251c\u2500\u2500 client.py           # External API client\n\u2502   \u2502   \u251c\u2500\u2500 schemas.py\n\u2502   \u2502   \u251c\u2500\u2500 models.py\n\u2502   \u2502   \u251c\u2500\u2500 service.py\n\u2502   \u2502   \u251c\u2500\u2500 config.py\n\u2502   \u2502   \u251c\u2500\u2500 constants.py\n\u2502   \u2502   \u251c\u2500\u2500 exceptions.py\n\u2502   \u2502   \u2514\u2500\u2500 utils.py\n\u2502   \u251c\u2500\u2500 config.py               # Global application configuration\n\u2502   \u251c\u2500\u2500 database.py             # Database connection and session management\n\u2502   \u251c\u2500\u2500 models.py               # Global database models and base classes\n\u2502   \u251c\u2500\u2500 exceptions.py           # Global exception classes\n\u2502   \u251c\u2500\u2500 dependencies.py         # Global dependencies (DB session, current user)\n\u2502   \u251c\u2500\u2500 pagination.py           # Pagination utilities\n\u2502   \u2514\u2500\u2500 main.py                 # FastAPI application factory\n\u251c\u2500\u2500 tests/                      # Test suite organized by domain\n\u2502   \u251c\u2500\u2500 auth/\n\u2502   \u251c\u2500\u2500 payment_methods/\n\u2502   \u251c\u2500\u2500 expense_templates/\n\u2502   \u251c\u2500\u2500 cycles/\n\u2502   \u251c\u2500\u2500 expenses/\n\u2502   \u251c\u2500\u2500 reports/\n\u2502   \u251c\u2500\u2500 exchange_rates/\n\u2502   \u251c\u2500\u2500 conftest.py            # Pytest configuration and fixtures\n\u2502   \u2514\u2500\u2500 utils.py               # Test utilities\n\u251c\u2500\u2500 .env                       # Environment variables\n\u251c\u2500\u2500 alembic.ini                # Alembic configuration\n\u251c\u2500\u2500 pyproject.toml             # Project configuration and dependencies\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"architecture/backend/#domain-architecture","title":"Domain Architecture","text":"<p>Each domain follows a consistent internal structure with clear responsibilities:</p>"},{"location":"architecture/backend/#file-responsibilities","title":"File Responsibilities","text":""},{"location":"architecture/backend/#routerpy","title":"router.py","text":"<p>Contains all HTTP endpoints for the domain. Handles request/response, validation, and delegates business logic to services.</p> <pre><code># Example: app/cycles/router.py\nfrom fastapi import APIRouter, Depends, HTTPException\nfrom sqlalchemy.orm import Session\n\nfrom app.dependencies import get_db, get_current_user\nfrom app.auth.models import User\nfrom . import service, schemas\n\nrouter = APIRouter(prefix=\"/cycles\", tags=[\"cycles\"])\n\n@router.post(\"/\", response_model=schemas.CycleResponse)\nasync def create_cycle(\n    cycle_data: schemas.CycleCreate,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    return await service.create_cycle(db, cycle_data, current_user.id)\n</code></pre>"},{"location":"architecture/backend/#schemaspy","title":"schemas.py","text":"<p>Pydantic models for request/response validation and serialization.</p> <pre><code># Example: app/cycles/schemas.py\nfrom datetime import date\nfrom decimal import Decimal\nfrom typing import Optional\nfrom pydantic import BaseModel\n\nclass CycleCreate(BaseModel):\n    name: str\n    start_date: date\n    end_date: date\n    income_amount: Decimal\n    generate_from_templates: bool = True\n\nclass CycleResponse(BaseModel):\n    id: str\n    name: str\n    start_date: date\n    end_date: date\n    income_amount: Decimal\n    status: str\n    created_at: datetime\n\n    class Config:\n        from_attributes = True\n</code></pre>"},{"location":"architecture/backend/#modelspy","title":"models.py","text":"<p>SQLAlchemy database models representing the domain's data structure.</p> <pre><code># Example: app/cycles/models.py\nfrom sqlalchemy import Column, String, Date, DECIMAL, ForeignKey\nfrom sqlalchemy.dialects.postgresql import UUID, ENUM\nfrom sqlalchemy.orm import relationship\n\nfrom app.models import BaseModel, CycleStatus\n\nclass Cycle(BaseModel):\n    __tablename__ = \"cycles\"\n\n    name = Column(String(100), nullable=False)\n    user_id = Column(UUID(as_uuid=True), ForeignKey(\"users.id\"), nullable=False)\n    start_date = Column(Date, nullable=False)\n    end_date = Column(Date, nullable=False)\n    income_amount = Column(DECIMAL(10, 2), default=0)\n    status = Column(ENUM(CycleStatus), default=CycleStatus.DRAFT)\n\n    # Relationships\n    user = relationship(\"User\", back_populates=\"cycles\")\n    expenses = relationship(\"CycleExpense\", back_populates=\"cycle\")\n</code></pre>"},{"location":"architecture/backend/#servicepy","title":"service.py","text":"<p>Contains the domain's business logic, data processing, and complex operations.</p> <pre><code># Example: app/cycles/service.py\nfrom sqlalchemy.orm import Session\nfrom typing import List\n\nfrom . import models, schemas\nfrom ..expense_templates import service as template_service\nfrom ..expenses import service as expense_service\n\nasync def create_cycle(\n    db: Session,\n    cycle_data: schemas.CycleCreate,\n    user_id: str\n) -&gt; models.Cycle:\n    \"\"\"Create a new cycle and optionally generate expenses from templates.\"\"\"\n\n    # Create cycle\n    cycle = models.Cycle(\n        name=cycle_data.name,\n        user_id=user_id,\n        start_date=cycle_data.start_date,\n        end_date=cycle_data.end_date,\n        income_amount=cycle_data.income_amount\n    )\n\n    db.add(cycle)\n    db.flush()  # Get cycle ID\n\n    # Generate expenses from templates if requested\n    if cycle_data.generate_from_templates:\n        await _generate_expenses_from_templates(db, cycle)\n\n    db.commit()\n    return cycle\n</code></pre>"},{"location":"architecture/backend/#dependenciespy","title":"dependencies.py","text":"<p>Domain-specific dependencies for dependency injection.</p> <pre><code># Example: app/cycles/dependencies.py\nfrom fastapi import Depends, HTTPException\nfrom sqlalchemy.orm import Session\n\nfrom app.dependencies import get_db, get_current_user\nfrom app.auth.models import User\nfrom . import service\nfrom .constants import ErrorCode\n\nasync def get_cycle_by_id(\n    cycle_id: str,\n    db: Session = Depends(get_db),\n    current_user: User = Depends(get_current_user)\n):\n    \"\"\"Dependency to get cycle by ID and verify ownership.\"\"\"\n    cycle = await service.get_cycle_by_id(db, cycle_id, current_user.id)\n    if not cycle:\n        raise HTTPException(\n            status_code=404,\n            detail=ErrorCode.CYCLE_NOT_FOUND\n        )\n    return cycle\n</code></pre>"},{"location":"architecture/backend/#constantspy","title":"constants.py","text":"<p>Domain-specific constants, error codes, and enums.</p> <pre><code># Example: app/cycles/constants.py\nfrom enum import Enum\n\nclass ErrorCode:\n    CYCLE_NOT_FOUND = \"CYCLE_NOT_FOUND\"\n    CYCLE_ALREADY_COMPLETED = \"CYCLE_ALREADY_COMPLETED\"\n    INVALID_CYCLE_DATES = \"INVALID_CYCLE_DATES\"\n    CYCLE_NAME_EXISTS = \"CYCLE_NAME_EXISTS\"\n\nclass CycleStatus(str, Enum):\n    DRAFT = \"draft\"\n    ACTIVE = \"active\"\n    COMPLETED = \"completed\"\n\n# Business constants\nMAX_CYCLE_DURATION_DAYS = 45\nDEFAULT_CYCLE_DURATION_DAYS = 42  # 6 weeks\n</code></pre>"},{"location":"architecture/backend/#exceptionspy","title":"exceptions.py","text":"<p>Domain-specific exception classes.</p> <pre><code># Example: app/cycles/exceptions.py\nfrom app.exceptions import AppException\nfrom .constants import ErrorCode\n\nclass CycleNotFoundException(AppException):\n    def __init__(self):\n        super().__init__(\n            error_code=ErrorCode.CYCLE_NOT_FOUND,\n            message=\"Cycle not found\",\n            status_code=404\n        )\n\nclass CycleAlreadyCompletedException(AppException):\n    def __init__(self):\n        super().__init__(\n            error_code=ErrorCode.CYCLE_ALREADY_COMPLETED,\n            message=\"Cannot modify completed cycle\",\n            status_code=409\n        )\n</code></pre>"},{"location":"architecture/backend/#utilspy","title":"utils.py","text":"<p>Domain-specific utility functions that don't contain business logic.</p> <pre><code># Example: app/cycles/utils.py\nfrom datetime import date, timedelta\nfrom typing import Tuple\n\ndef calculate_cycle_dates(start_date: date) -&gt; Tuple[date, date]:\n    \"\"\"Calculate 6-week cycle end date from start date.\"\"\"\n    end_date = start_date + timedelta(days=42)  # 6 weeks\n    return start_date, end_date\n\ndef format_cycle_name(start_date: date, end_date: date) -&gt; str:\n    \"\"\"Generate a descriptive cycle name from dates.\"\"\"\n    return f\"{start_date.strftime('%B %Y')} Cycle\"\n</code></pre>"},{"location":"architecture/backend/#global-architecture-components","title":"Global Architecture Components","text":""},{"location":"architecture/backend/#appmainpy","title":"app/main.py","text":"<p>Application factory that initializes FastAPI with all domain routers.</p> <pre><code>from fastapi import FastAPI\nfrom fastapi.middleware.cors import CORSMiddleware\n\nfrom app.config import settings\nfrom app.auth.router import router as auth_router\nfrom app.cycles.router import router as cycles_router\nfrom app.expenses.router import router as expenses_router\n# ... other routers\n\ndef create_app() -&gt; FastAPI:\n    app = FastAPI(\n        title=\"Colony API\",\n        version=\"1.0.0\",\n        description=\"Personal expense management API\"\n    )\n\n    # Middleware\n    app.add_middleware(\n        CORSMiddleware,\n        allow_origins=settings.ALLOWED_HOSTS,\n        allow_credentials=True,\n        allow_methods=[\"*\"],\n        allow_headers=[\"*\"],\n    )\n\n    # Include domain routers\n    app.include_router(auth_router, prefix=\"/api/v1\")\n    app.include_router(cycles_router, prefix=\"/api/v1\")\n    app.include_router(expenses_router, prefix=\"/api/v1\")\n\n    return app\n\napp = create_app()\n</code></pre>"},{"location":"architecture/backend/#appdatabasepy","title":"app/database.py","text":"<p>Database connection and session management.</p> <pre><code>from sqlalchemy import create_engine\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy.orm import sessionmaker\n\nfrom app.config import settings\n\nengine = create_engine(settings.DATABASE_URL)\nSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\n\nBase = declarative_base()\n\ndef get_db():\n    \"\"\"Database session dependency.\"\"\"\n    db = SessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n</code></pre>"},{"location":"architecture/backend/#appmodelspy","title":"app/models.py","text":"<p>Base model classes and global models.</p> <pre><code>from sqlalchemy import Column, DateTime, Boolean\nfrom sqlalchemy.dialects.postgresql import UUID\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom datetime import datetime\nimport uuid\n\nBase = declarative_base()\n\nclass BaseModel(Base):\n    \"\"\"Base model with common fields.\"\"\"\n    __abstract__ = True\n\n    id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    created_at = Column(DateTime, default=datetime.utcnow)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n    active = Column(Boolean, default=True)\n</code></pre>"},{"location":"architecture/backend/#appdependenciespy","title":"app/dependencies.py","text":"<p>Global dependencies used across domains.</p> <pre><code>from fastapi import Depends, HTTPException, status\nfrom fastapi.security import HTTPBearer\nfrom sqlalchemy.orm import Session\n\nfrom app.database import get_db\nfrom app.auth import service as auth_service\n\nsecurity = HTTPBearer()\n\nasync def get_current_user(\n    token: str = Depends(security),\n    db: Session = Depends(get_db)\n):\n    \"\"\"Get current authenticated user from JWT token.\"\"\"\n    user = await auth_service.get_user_from_token(db, token.credentials)\n    if not user:\n        raise HTTPException(\n            status_code=status.HTTP_401_UNAUTHORIZED,\n            detail=\"Invalid authentication credentials\"\n        )\n    return user\n</code></pre>"},{"location":"architecture/backend/#cross-domain-communication","title":"Cross-Domain Communication","text":"<p>When domains need to interact, they import services explicitly:</p> <pre><code># In app/cycles/service.py\nfrom app.expense_templates import service as template_service\nfrom app.expenses import service as expense_service\nfrom app.exchange_rates import service as exchange_service\n\nasync def create_cycle_with_expenses(db: Session, cycle_data: schemas.CycleCreate):\n    # Get user's templates\n    templates = await template_service.get_active_templates(db, cycle_data.user_id)\n\n    # Generate expenses for each template\n    for template in templates:\n        expenses = await expense_service.generate_from_template(\n            db, template, cycle_data.start_date, cycle_data.end_date\n        )\n\n        # Convert currencies if needed\n        for expense in expenses:\n            if expense.currency != \"USD\":\n                usd_amount = await exchange_service.convert_to_usd(\n                    expense.amount, expense.currency\n                )\n                expense.amount_usd = usd_amount\n</code></pre>"},{"location":"architecture/backend/#data-flow-architecture","title":"Data Flow Architecture","text":"<pre><code>graph TD\n    A[HTTP Request] --&gt; B[Router Layer]\n    B --&gt; C[Pydantic Validation]\n    C --&gt; D[Dependency Injection]\n    D --&gt; E[Service Layer]\n    E --&gt; F[Database Models]\n    F --&gt; G[SQLAlchemy ORM]\n    G --&gt; H[PostgreSQL]\n\n    E --&gt; I[External Services]\n    I --&gt; J[Exchange Rate APIs]\n\n    E --&gt; K[Cross-Domain Services]\n    K --&gt; L[Other Domain Services]\n\n    H --&gt; G\n    G --&gt; F\n    F --&gt; E\n    E --&gt; M[Response Schemas]\n    M --&gt; N[HTTP Response]</code></pre>"},{"location":"architecture/backend/#key-architecture-benefits","title":"Key Architecture Benefits","text":""},{"location":"architecture/backend/#1-modularity","title":"1. Modularity","text":"<ul> <li>Each domain is self-contained</li> <li>Easy to add new features without affecting other domains</li> <li>Clear boundaries and responsibilities</li> </ul>"},{"location":"architecture/backend/#2-testability","title":"2. Testability","text":"<ul> <li>Each layer can be tested independently</li> <li>Mock dependencies easily</li> <li>Domain-specific test suites</li> </ul>"},{"location":"architecture/backend/#3-maintainability","title":"3. Maintainability","text":"<ul> <li>Consistent structure across domains</li> <li>Easy to locate and modify code</li> <li>Clear separation of concerns</li> </ul>"},{"location":"architecture/backend/#4-scalability","title":"4. Scalability","text":"<ul> <li>Domains can be extracted to microservices if needed</li> <li>Independent development by different teams</li> <li>Horizontal scaling capabilities</li> </ul>"},{"location":"architecture/backend/#5-type-safety","title":"5. Type Safety","text":"<ul> <li>Full type annotations</li> <li>Pydantic validation</li> <li>SQLAlchemy type mapping</li> </ul>"},{"location":"architecture/backend/#authentication-security","title":"Authentication &amp; Security","text":""},{"location":"architecture/backend/#jwt-authentication","title":"JWT Authentication","text":"<p>The application uses JSON Web Tokens (JWT) for stateless authentication:</p> <pre><code># app/auth/config.py\nclass AuthSettings(BaseSettings):\n    SECRET_KEY: str = \"your-secret-key-here\"  # Change in production\n    ALGORITHM: str = \"HS256\"\n    ACCESS_TOKEN_EXPIRE_MINUTES: int = 30\n\n    class Config:\n        env_file = \".env\"\n        env_prefix = \"AUTH_\"\n</code></pre>"},{"location":"architecture/backend/#token-flow","title":"Token Flow","text":"<ol> <li>User authenticates via <code>/auth/login</code> with email/password</li> <li>System returns JWT token with user claims</li> <li>Client includes token in <code>Authorization: Bearer &lt;token&gt;</code> header</li> <li>System validates token on protected endpoints</li> </ol>"},{"location":"architecture/backend/#password-security","title":"Password Security","text":"<ul> <li>Passwords hashed using Argon2ID algorithm</li> <li>Minimum 8 characters required</li> <li>Salt automatically generated per password</li> </ul> <pre><code># app/auth/utils.py\nfrom argon2 import PasswordHasher\nfrom argon2.exceptions import VerifyMismatchError\n\nph = PasswordHasher()\n\ndef hash_password(password: str) -&gt; str:\n    \"\"\"Hash password using Argon2ID.\"\"\"\n    return ph.hash(password)\n\ndef verify_password(plain_password: str, hashed_password: str) -&gt; bool:\n    \"\"\"Verify password against hash.\"\"\"\n    try:\n        ph.verify(hashed_password, plain_password)\n        return True\n    except VerifyMismatchError:\n        return False\n</code></pre>"},{"location":"architecture/backend/#authentication-dependencies","title":"Authentication Dependencies","text":"<p>Global authentication handled via dependency injection:</p> <pre><code># app/dependencies.py\nfrom app.auth.dependencies import get_current_active_user\n\n# Use in any protected endpoint\n@router.get(\"/protected\")\nasync def protected_endpoint(\n    current_user: CurrentActiveUser  # Automatically validates JWT\n):\n    return {\"user\": current_user.email}\n</code></pre>"},{"location":"architecture/backend/#error-handling-architecture","title":"Error Handling Architecture","text":""},{"location":"architecture/backend/#exception-hierarchy","title":"Exception Hierarchy","text":"<p>Structured exception handling with consistent error responses:</p> <pre><code># app/exceptions.py\nclass AppException(Exception):\n    \"\"\"Base application exception.\"\"\"\n\n    def __init__(self, error_code: str, message: str, status_code: int = 400, details: dict = None):\n        self.error_code = error_code\n        self.message = message\n        self.status_code = status_code\n        self.details = details or {}\n        super().__init__(self.message)\n\n# Domain-specific exceptions inherit from AppException\nclass UserNotFoundException(AppException):\n    def __init__(self):\n        super().__init__(\n            error_code=\"USER_NOT_FOUND\",\n            message=\"User not found\",\n            status_code=404\n        )\n</code></pre>"},{"location":"architecture/backend/#global-exception-handlers","title":"Global Exception Handlers","text":"<p>Centralized error handling for consistent API responses:</p> <pre><code># app/exceptions.py\nfrom fastapi import Request, HTTPException\nfrom fastapi.responses import JSONResponse\n\nasync def app_exception_handler(request: Request, exc: AppException):\n    \"\"\"Handle application-specific exceptions.\"\"\"\n    return JSONResponse(\n        status_code=exc.status_code,\n        content={\n            \"success\": False,\n            \"error\": {\n                \"code\": exc.error_code,\n                \"message\": exc.message,\n                \"details\": exc.details\n            }\n        }\n    )\n\nasync def validation_exception_handler(request: Request, exc: ValueError):\n    \"\"\"Handle validation errors.\"\"\"\n    return JSONResponse(\n        status_code=422,\n        content={\n            \"success\": False,\n            \"error\": {\n                \"code\": \"VALIDATION_ERROR\",\n                \"message\": str(exc),\n                \"details\": {}\n            }\n        }\n    )\n</code></pre>"},{"location":"architecture/backend/#error-response-format","title":"Error Response Format","text":"<p>All errors follow a consistent structure:</p> <pre><code>{\n  \"success\": false,\n  \"error\": {\n    \"code\": \"USER_NOT_FOUND\",\n    \"message\": \"User not found\",\n    \"details\": {\n      \"user_id\": \"123e4567-e89b-12d3-a456-426614174000\"\n    }\n  }\n}\n</code></pre>"},{"location":"architecture/backend/#database-architecture","title":"Database Architecture","text":""},{"location":"architecture/backend/#connection-management","title":"Connection Management","text":"<p>PostgreSQL connection using SQLAlchemy with connection pooling:</p> <pre><code># app/database.py\nfrom sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker\nfrom app.config import settings\n\n# Connection pool configuration\nengine = create_engine(\n    settings.DATABASE_URL,\n    pool_pre_ping=True,           # Verify connections before use\n    pool_recycle=300,             # Recycle connections every 5 minutes\n    pool_size=10,                 # Connection pool size\n    max_overflow=20               # Additional connections if needed\n)\n\nSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\n</code></pre>"},{"location":"architecture/backend/#migration-strategy","title":"Migration Strategy","text":"<p>Database versioning using Alembic:</p> <pre><code># Generate migration\nalembic revision --autogenerate -m \"add user table\"\n\n# Apply migrations\nalembic upgrade head\n\n# Rollback\nalembic downgrade -1\n</code></pre>"},{"location":"architecture/backend/#model-conventions","title":"Model Conventions","text":"<p>Consistent database modeling patterns:</p> <pre><code># app/models.py\nimport uuid\nfrom datetime import datetime\nfrom sqlalchemy import Column, DateTime, Boolean, String\nfrom sqlalchemy.dialects.postgresql import UUID\nfrom sqlalchemy.ext.declarative import declarative_base\n\nBase = declarative_base()\n\nclass BaseModel(Base):\n    \"\"\"Base model with common fields and behaviors.\"\"\"\n    __abstract__ = True\n\n    id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n    created_at = Column(DateTime, default=datetime.utcnow, nullable=False)\n    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow, nullable=False)\n    active = Column(Boolean, default=True, nullable=False)\n\n    def to_dict(self) -&gt; dict:\n        \"\"\"Convert model to dictionary.\"\"\"\n        return {c.name: getattr(self, c.name) for c in self.__table__.columns}\n</code></pre>"},{"location":"architecture/backend/#validation-serialization","title":"Validation &amp; Serialization","text":""},{"location":"architecture/backend/#pydantic-models","title":"Pydantic Models","text":"<p>Type-safe request/response handling:</p> <pre><code># Domain schemas follow naming conventions\nclass UserCreate(BaseModel):      # For POST requests\n    email: EmailStr\n    password: str\n    first_name: Optional[str]\n\nclass UserUpdate(BaseModel):      # For PUT/PATCH requests\n    first_name: Optional[str]\n    last_name: Optional[str]\n\nclass UserResponse(BaseModel):    # For API responses\n    id: str\n    email: str\n    first_name: Optional[str]\n    active: bool\n    created_at: datetime\n\n    class Config:\n        from_attributes = True    # Enable SQLAlchemy model conversion\n</code></pre>"},{"location":"architecture/backend/#custom-validators","title":"Custom Validators","text":"<p>Domain-specific validation logic:</p> <pre><code>from pydantic import validator\nfrom decimal import Decimal\n\nclass ExpenseCreate(BaseModel):\n    amount: Decimal\n    description: str\n\n    @validator('amount')\n    def amount_must_be_positive(cls, v):\n        if v &lt;= 0:\n            raise ValueError('Amount must be positive')\n        if v &gt; Decimal('999999.99'):\n            raise ValueError('Amount too large')\n        return v\n\n    @validator('description')\n    def description_length(cls, v):\n        if len(v.strip()) &lt; 1:\n            raise ValueError('Description cannot be empty')\n        return v.strip()\n</code></pre>"},{"location":"architecture/backend/#testing-architecture","title":"Testing Architecture","text":""},{"location":"architecture/backend/#test-organization","title":"Test Organization","text":"<p>Tests mirror the domain structure:</p> <pre><code>tests/\n\u251c\u2500\u2500 conftest.py              # Global test fixtures\n\u251c\u2500\u2500 test_auth/               # Authentication tests\n\u2502   \u251c\u2500\u2500 test_service.py      # Business logic tests\n\u2502   \u251c\u2500\u2500 test_router.py       # API endpoint tests\n\u2502   \u2514\u2500\u2500 test_models.py       # Database model tests\n\u251c\u2500\u2500 test_cycles/\n\u2514\u2500\u2500 utils.py                 # Test utilities\n</code></pre>"},{"location":"architecture/backend/#test-database","title":"Test Database","text":"<p>Isolated test database for each test session:</p> <pre><code># tests/conftest.py\nimport pytest\nfrom sqlalchemy import create_engine\nfrom sqlalchemy.orm import sessionmaker\nfrom app.database import Base, get_db\nfrom app.main import app\n\n# Test database\nTEST_DATABASE_URL = \"postgresql://test_user:test_pass@localhost/test_colony\"\ntest_engine = create_engine(TEST_DATABASE_URL)\nTestingSessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=test_engine)\n\n@pytest.fixture(scope=\"session\")\ndef test_db():\n    \"\"\"Create test database tables.\"\"\"\n    Base.metadata.create_all(bind=test_engine)\n    yield\n    Base.metadata.drop_all(bind=test_engine)\n\n@pytest.fixture\ndef db_session(test_db):\n    \"\"\"Provide database session for tests.\"\"\"\n    db = TestingSessionLocal()\n    try:\n        yield db\n    finally:\n        db.close()\n\n@pytest.fixture\ndef client(db_session):\n    \"\"\"FastAPI test client with database override.\"\"\"\n    def override_get_db():\n        yield db_session\n\n    app.dependency_overrides[get_db] = override_get_db\n    yield TestClient(app)\n    app.dependency_overrides.clear()\n</code></pre>"},{"location":"architecture/backend/#test-patterns","title":"Test Patterns","text":"<p>Consistent testing approaches:</p> <pre><code># tests/test_auth/test_service.py\nimport pytest\nfrom app.auth import service\nfrom app.auth.exceptions import UserAlreadyExistsException\n\nclass TestAuthService:\n    def test_create_user_success(self, db_session):\n        \"\"\"Test successful user creation.\"\"\"\n        user_data = {\n            \"email\": \"test@example.com\",\n            \"password\": \"securepass123\"\n        }\n\n        user = service.create_user(db_session, user_data)\n\n        assert user.email == \"test@example.com\"\n        assert user.active is True\n        assert user.id is not None\n\n    def test_create_user_duplicate_email(self, db_session):\n        \"\"\"Test duplicate email handling.\"\"\"\n        user_data = {\n            \"email\": \"test@example.com\",\n            \"password\": \"securepass123\"\n        }\n\n        # Create first user\n        service.create_user(db_session, user_data)\n\n        # Attempt to create duplicate\n        with pytest.raises(UserAlreadyExistsException):\n            service.create_user(db_session, user_data)\n</code></pre>"},{"location":"architecture/backend/#configuration-management","title":"Configuration Management","text":""},{"location":"architecture/backend/#environment-based-config","title":"Environment-based Config","text":"<p>Secure configuration using Pydantic settings:</p> <pre><code># app/config.py\nfrom pydantic_settings import BaseSettings\nfrom typing import List\n\nclass Settings(BaseSettings):\n    # Application\n    APP_NAME: str = \"Colony API\"\n    VERSION: str = \"1.0.0\"\n    DEBUG: bool = False\n\n    # Database\n    DATABASE_URL: str\n\n    # Security\n    SECRET_KEY: str\n    ALLOWED_HOSTS: List[str] = [\"*\"]\n\n    # External APIs\n    EXCHANGE_RATE_API_KEY: str\n    EXCHANGE_RATE_API_URL: str = \"https://api.exchangerate-api.com/v4/latest\"\n\n    # Logging\n    LOG_LEVEL: str = \"INFO\"\n\n    class Config:\n        env_file = \".env\"\n        case_sensitive = True\n\nsettings = Settings()\n</code></pre>"},{"location":"architecture/backend/#environment-files","title":"Environment Files","text":"<p>Development and production configurations:</p> <pre><code># .env.development\nDATABASE_URL=postgresql://colony_user:colony_pass@localhost:5432/colony_dev\nSECRET_KEY=development-secret-key\nDEBUG=true\nLOG_LEVEL=DEBUG\n\n# .env.production\nDATABASE_URL=postgresql://user:pass@prod-db:5432/colony_prod\nSECRET_KEY=${COLONY_SECRET_KEY}\nDEBUG=false\nLOG_LEVEL=INFO\nALLOWED_HOSTS=[\"api.colony.app\"]\n</code></pre>"},{"location":"architecture/backend/#logging-monitoring","title":"Logging &amp; Monitoring","text":""},{"location":"architecture/backend/#structured-logging","title":"Structured Logging","text":"<p>Consistent logging across all domains:</p> <pre><code># app/logging.py\nimport logging\nimport json\nfrom typing import Any, Dict\n\nclass JSONFormatter(logging.Formatter):\n    \"\"\"JSON log formatter for structured logging.\"\"\"\n\n    def format(self, record: logging.LogRecord) -&gt; str:\n        log_data: Dict[str, Any] = {\n            \"timestamp\": self.formatTime(record),\n            \"level\": record.levelname,\n            \"module\": record.module,\n            \"message\": record.getMessage(),\n        }\n\n        if hasattr(record, 'user_id'):\n            log_data['user_id'] = record.user_id\n\n        if record.exc_info:\n            log_data['exception'] = self.formatException(record.exc_info)\n\n        return json.dumps(log_data)\n\n# Usage in services\nlogger = logging.getLogger(__name__)\n\nasync def create_user(db: Session, user_data: dict):\n    logger.info(\"Creating new user\", extra={\"email\": user_data[\"email\"]})\n    try:\n        # ... business logic\n        logger.info(\"User created successfully\", extra={\"user_id\": str(user.id)})\n        return user\n    except Exception as e:\n        logger.error(\"Failed to create user\", extra={\"error\": str(e)})\n        raise\n</code></pre>"},{"location":"architecture/backend/#performance-considerations","title":"Performance Considerations","text":""},{"location":"architecture/backend/#database-query-optimization","title":"Database Query Optimization","text":"<ul> <li>Use <code>select_related()</code> for foreign key relationships</li> <li>Implement pagination for large datasets</li> <li>Add database indexes for frequently queried fields</li> <li>Use database-level constraints for data integrity</li> </ul>"},{"location":"architecture/backend/#caching-strategy","title":"Caching Strategy","text":"<ul> <li>Redis for session data and frequently accessed lookups</li> <li>Application-level caching for exchange rates</li> <li>Query result caching for expensive reports</li> </ul>"},{"location":"architecture/backend/#async-operations","title":"Async Operations","text":"<ul> <li>Use <code>async</code>/<code>await</code> for I/O operations</li> <li>Background tasks for non-critical operations (emails, reports)</li> <li>Connection pooling for database and external API calls</li> </ul> <p>This architecture provides a robust foundation for building a maintainable, scalable, and secure expense management API while following FastAPI and Python best practices.</p>"},{"location":"architecture/database-schema/","title":"Database Schema","text":"<p>Colony uses PostgreSQL for reliable financial data management with ACID transactions and complex relationship queries.</p>"},{"location":"architecture/database-schema/#database-choice-postgresql","title":"Database Choice: PostgreSQL","text":"<ul> <li>ACID Compliance: Essential for financial data integrity</li> <li>Complex Queries: Supports advanced reporting and analytics</li> <li>JSON Support: Flexible configuration storage (recurrence patterns)</li> <li>Decimal Precision: Accurate financial calculations</li> <li>Mature Ecosystem: Well-supported with excellent tooling</li> </ul>"},{"location":"architecture/database-schema/#schema-overview","title":"Schema Overview","text":"<pre><code>erDiagram\n    users ||--o{ payment_methods : owns\n    users ||--o{ expense_templates : creates\n    users ||--o{ cycles : manages\n    cycles ||--o{ cycle_expenses : contains\n    expense_templates ||--o{ cycle_expenses : generates\n    payment_methods ||--o{ expense_templates : uses\n    payment_methods ||--o{ cycle_expenses : uses\n\n    users {\n        uuid id PK\n        string email UK\n        string password_hash\n        string first_name\n        string last_name\n        string preferred_currency\n        string locale\n        boolean active\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    payment_methods {\n        uuid id PK\n        uuid user_id FK\n        string name\n        string method_type\n        string default_currency\n        string description\n        boolean active\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    expense_templates {\n        uuid id PK\n        uuid user_id FK\n        uuid payment_method_id FK\n        string description\n        string currency\n        decimal base_amount\n        string category\n        string recurrence_type\n        json recurrence_config\n        date reference_date\n        string autopay_info\n        boolean active\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    cycles {\n        uuid id PK\n        uuid user_id FK\n        date start_date\n        date end_date\n        decimal income_amount\n        decimal remaining_balance\n        string status\n        string name\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    cycle_expenses {\n        uuid id PK\n        uuid cycle_id FK\n        uuid template_id FK\n        uuid payment_method_id FK\n        string description\n        string currency\n        decimal amount\n        decimal amount_usd\n        date due_date\n        string category\n        string autopay_info\n        string status\n        string comments\n        boolean paid\n        timestamp paid_at\n        timestamp created_at\n        timestamp updated_at\n    }\n\n    exchange_rates {\n        uuid id PK\n        string from_currency\n        string to_currency\n        decimal rate\n        date rate_date\n        timestamp created_at\n    }</code></pre>"},{"location":"architecture/database-schema/#global-types","title":"Global Types","text":"<p>Before creating tables, we define custom types that ensure data consistency across the schema:</p> <pre><code>-- ===========================================\n-- GLOBAL ENUMS (Create these first)\n-- ===========================================\n\n-- Supported currencies (ISO 4217 codes)\nCREATE TYPE currency_code AS ENUM ('USD', 'MXN');\n\n-- Payment method types\nCREATE TYPE payment_method_type AS ENUM ('debit', 'credit', 'cash', 'transfer');\n\n-- Expense categorization\nCREATE TYPE expense_category AS ENUM ('fixed', 'variable');\n\n-- Template recurrence patterns\nCREATE TYPE recurrence_type AS ENUM ('weekly', 'bi_weekly', 'monthly', 'custom');\n\n-- Cycle lifecycle states\nCREATE TYPE cycle_status AS ENUM ('draft', 'active', 'completed');\n\n-- Individual expense states\nCREATE TYPE expense_status AS ENUM ('pending', 'paid', 'cancelled', 'overdue');\n</code></pre>"},{"location":"architecture/database-schema/#enum-descriptions","title":"ENUM Descriptions","text":"Type Values Description <code>currency_code</code> <code>USD</code>, <code>MXN</code> ISO 4217 currency codes for supported currencies <code>payment_method_type</code> <code>debit</code>, <code>credit</code>, <code>cash</code>, <code>transfer</code> Types of payment methods available <code>expense_category</code> <code>fixed</code>, <code>variable</code> Expense categorization for budgeting <code>recurrence_type</code> <code>weekly</code>, <code>bi_weekly</code>, <code>monthly</code>, <code>custom</code> How often template expenses recur <code>cycle_status</code> <code>draft</code>, <code>active</code>, <code>completed</code> Lifecycle state of expense cycles <code>expense_status</code> <code>pending</code>, <code>paid</code>, <code>cancelled</code>, <code>overdue</code> Current state of individual expenses"},{"location":"architecture/database-schema/#table-definitions","title":"Table Definitions","text":""},{"location":"architecture/database-schema/#users","title":"Users","text":"<p>Primary user accounts for the application.</p> <pre><code>CREATE TABLE users (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    email VARCHAR(255) UNIQUE NOT NULL,\n    password_hash VARCHAR(255) NOT NULL,\n    first_name VARCHAR(100),\n    last_name VARCHAR(100),\n    preferred_currency currency_code DEFAULT 'USD',  -- Uses global ENUM\n    locale VARCHAR(10) DEFAULT 'en-US',\n    active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\nCREATE INDEX idx_users_email ON users(email);\nCREATE INDEX idx_users_active ON users(active);\n</code></pre>"},{"location":"architecture/database-schema/#payment-methods","title":"Payment Methods","text":"<p>User-defined payment methods (cards, accounts, cash).</p> <pre><code>CREATE TABLE payment_methods (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    name VARCHAR(100) NOT NULL,\n    method_type payment_method_type NOT NULL,        -- Uses global ENUM\n    default_currency currency_code NOT NULL,         -- Uses global ENUM\n    description TEXT,\n    active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n\n    CONSTRAINT unique_user_payment_method_name UNIQUE(user_id, name)\n);\n\nCREATE INDEX idx_payment_methods_user_id ON payment_methods(user_id);\nCREATE INDEX idx_payment_methods_active ON payment_methods(active);\n</code></pre>"},{"location":"architecture/database-schema/#expense-templates","title":"Expense Templates","text":"<p>Reusable templates for recurring expenses.</p> <pre><code>CREATE TABLE expense_templates (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    payment_method_id UUID NOT NULL REFERENCES payment_methods(id),\n    description VARCHAR(255) NOT NULL,\n    currency currency_code NOT NULL,\n    base_amount DECIMAL(10,2) NOT NULL CHECK (base_amount &gt; 0),\n    category expense_category NOT NULL,\n    recurrence_type recurrence_type NOT NULL,\n    recurrence_config JSONB NOT NULL DEFAULT '{}',\n    reference_date DATE NOT NULL,  -- Last known occurrence (e.g., \"1/12/2025 - last insurance bill\")\n    autopay_info TEXT,\n    active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\nCREATE INDEX idx_expense_templates_user_id ON expense_templates(user_id);\nCREATE INDEX idx_expense_templates_active ON expense_templates(active);\nCREATE INDEX idx_expense_templates_category ON expense_templates(category);\n</code></pre>"},{"location":"architecture/database-schema/#cycles","title":"Cycles","text":"<p>6-week expense management periods.</p> <pre><code>CREATE TABLE cycles (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n    name VARCHAR(100) NOT NULL,\n    start_date DATE NOT NULL,\n    end_date DATE NOT NULL,\n    income_amount DECIMAL(10,2) NOT NULL DEFAULT 0,\n    remaining_balance DECIMAL(10,2) NOT NULL DEFAULT 0,\n    status cycle_status DEFAULT 'draft',\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n\n    CONSTRAINT valid_cycle_dates CHECK (end_date &gt; start_date),\n    CONSTRAINT unique_user_cycle_name UNIQUE(user_id, name)\n);\n\nCREATE INDEX idx_cycles_user_id ON cycles(user_id);\nCREATE INDEX idx_cycles_status ON cycles(status);\nCREATE INDEX idx_cycles_dates ON cycles(start_date, end_date);\n</code></pre>"},{"location":"architecture/database-schema/#cycle-expenses","title":"Cycle Expenses","text":"<p>Individual expenses within a cycle.</p> <pre><code>CREATE TABLE cycle_expenses (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    cycle_id UUID NOT NULL REFERENCES cycles(id) ON DELETE CASCADE,\n    template_id UUID REFERENCES expense_templates(id),\n    payment_method_id UUID NOT NULL REFERENCES payment_methods(id),\n    description VARCHAR(255) NOT NULL,\n    currency currency_code NOT NULL,\n    amount DECIMAL(10,2) NOT NULL CHECK (amount &gt; 0),\n    amount_usd DECIMAL(10,2) NOT NULL CHECK (amount_usd &gt; 0),\n    due_date DATE NOT NULL,\n    category expense_category NOT NULL,\n    autopay_info TEXT,\n    status expense_status DEFAULT 'pending',\n    comments TEXT,\n    paid BOOLEAN DEFAULT false,\n    paid_at TIMESTAMP WITH TIME ZONE,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\nCREATE INDEX idx_cycle_expenses_cycle_id ON cycle_expenses(cycle_id);\nCREATE INDEX idx_cycle_expenses_template_id ON cycle_expenses(template_id);\nCREATE INDEX idx_cycle_expenses_due_date ON cycle_expenses(due_date);\nCREATE INDEX idx_cycle_expenses_status ON cycle_expenses(status);\nCREATE INDEX idx_cycle_expenses_paid ON cycle_expenses(paid);\n</code></pre>"},{"location":"architecture/database-schema/#exchange-rates","title":"Exchange Rates","text":"<p>Currency conversion rates for financial calculations.</p> <pre><code>CREATE TABLE exchange_rates (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    from_currency currency_code NOT NULL,\n    to_currency currency_code NOT NULL,\n    rate DECIMAL(10,6) NOT NULL CHECK (rate &gt; 0),\n    rate_date DATE NOT NULL,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n\n    CONSTRAINT unique_currency_date UNIQUE(from_currency, to_currency, rate_date)\n);\n\nCREATE INDEX idx_exchange_rates_currencies ON exchange_rates(from_currency, to_currency);\nCREATE INDEX idx_exchange_rates_date ON exchange_rates(rate_date);\n</code></pre>"},{"location":"architecture/database-schema/#relationship-details","title":"Relationship Details","text":""},{"location":"architecture/database-schema/#user-payment-methods-1n","title":"User \u2192 Payment Methods (1:N)","text":"<ul> <li>Users can have multiple payment methods</li> <li>Payment methods belong to one user</li> <li>Soft delete preserves historical data</li> </ul>"},{"location":"architecture/database-schema/#user-expense-templates-1n","title":"User \u2192 Expense Templates (1:N)","text":"<ul> <li>Users create multiple templates</li> <li>Templates define recurring expense patterns</li> <li>Templates reference payment methods</li> </ul>"},{"location":"architecture/database-schema/#user-cycles-1n","title":"User \u2192 Cycles (1:N)","text":"<ul> <li>Users manage multiple 6-week cycles</li> <li>Each cycle has defined start/end dates</li> <li>Cycles track income and remaining balance</li> </ul>"},{"location":"architecture/database-schema/#cycle-cycle-expenses-1n","title":"Cycle \u2192 Cycle Expenses (1:N)","text":"<ul> <li>Each cycle contains multiple expenses</li> <li>Expenses can be generated from templates</li> <li>Manual expenses allowed within cycles</li> </ul>"},{"location":"architecture/database-schema/#template-cycle-expenses-1n","title":"Template \u2192 Cycle Expenses (1:N)","text":"<ul> <li>Templates can generate multiple expenses across cycles</li> <li>Relationship tracks which template generated each expense</li> <li>Optional relationship (manual expenses have NULL template_id)</li> </ul>"},{"location":"architecture/database-schema/#recurrence-configuration-schema","title":"Recurrence Configuration Schema","text":"<p>The <code>recurrence_config</code> JSONB field stores type-specific configuration for calculating expense occurrences. The schema varies based on the <code>recurrence_type</code>.</p>"},{"location":"architecture/database-schema/#weekly-recurrence","title":"Weekly Recurrence","text":"<p>For expenses that occur on a specific day of the week (e.g., every Saturday for groceries).</p> <pre><code>{\n  \"day_of_week\": 6\n}\n</code></pre> <p>Schema: - <code>day_of_week</code> (integer, required): Day of the week (0=Sunday, 1=Monday, ..., 6=Saturday)</p> <p>Examples: <pre><code>// Every Saturday (groceries)\n{\n  \"day_of_week\": 6\n}\n\n// Every Tuesday (therapy appointment)\n{\n  \"day_of_week\": 2\n}\n</code></pre></p> <p>Calculation Logic: 1. Find the first occurrence of <code>day_of_week</code> on or after cycle start date 2. Generate weekly occurrences until cycle end date 3. Reference date is used to validate the pattern matches historical data</p>"},{"location":"architecture/database-schema/#bi-weekly-recurrence","title":"Bi-Weekly Recurrence","text":"<p>For expenses that occur every 14 days, typically aligned with pay cycles.</p> <pre><code>{\n  \"interval_days\": 14\n}\n</code></pre> <p>Schema: - <code>interval_days</code> (integer, required): Number of days between occurrences (typically 14)</p> <p>Examples: <pre><code>// Every 14 days (bi-weekly paycheck deductions)\n{\n  \"interval_days\": 14\n}\n\n// Every 10 days (custom medication refill)\n{\n  \"interval_days\": 10\n}\n</code></pre></p> <p>Calculation Logic: 1. Start from reference date 2. Add/subtract <code>interval_days</code> to find occurrences within cycle period 3. Generate all dates that fall within cycle start/end dates</p>"},{"location":"architecture/database-schema/#monthly-recurrence","title":"Monthly Recurrence","text":"<p>For expenses that occur on the same day each month (e.g., rent, utilities).</p> <pre><code>{\n  \"day_of_month\": 15\n}\n</code></pre> <p>Schema: - <code>day_of_month</code> (integer, required): Day of the month (1-31) - <code>handle_month_end</code> (boolean, optional): How to handle months with fewer days (default: false)</p> <p>Examples: <pre><code>// 1st of every month (rent)\n{\n  \"day_of_month\": 1\n}\n\n// 15th of every month (credit card payment)\n{\n  \"day_of_month\": 15\n}\n\n// Last day of month (salary)\n{\n  \"day_of_month\": 31,\n  \"handle_month_end\": true\n}\n</code></pre></p> <p>Calculation Logic: 1. For each month that overlaps with cycle period 2. Use <code>day_of_month</code> as the occurrence date 3. If <code>handle_month_end</code> is true and <code>day_of_month</code> &gt; days in month, use last day of month 4. Skip months where the calculated date is outside cycle period</p>"},{"location":"architecture/database-schema/#custom-recurrence","title":"Custom Recurrence","text":"<p>For complex patterns like quarterly, semi-annual, or irregular intervals.</p> <pre><code>{\n  \"interval\": 3,\n  \"unit\": \"months\",\n  \"day_of_month\": 15\n}\n</code></pre> <p>Schema: - <code>interval</code> (integer, required): Number of units between occurrences - <code>unit</code> (string, required): Time unit - one of: \"days\", \"weeks\", \"months\", \"years\" - <code>day_of_month</code> (integer, optional): Specific day for month/year units (1-31) - <code>month_of_year</code> (integer, optional): Specific month for year units (1-12) - <code>day_of_week</code> (integer, optional): Specific day for week units (0-6)</p> <p>Examples: <pre><code>// Every 3 months on the 15th (quarterly insurance)\n{\n  \"interval\": 3,\n  \"unit\": \"months\",\n  \"day_of_month\": 15\n}\n\n// Every 2 months on the 1st (bi-monthly subscription)\n{\n  \"interval\": 2,\n  \"unit\": \"months\",\n  \"day_of_month\": 1\n}\n\n// Every 6 months on the 1st (semi-annual payment)\n{\n  \"interval\": 6,\n  \"unit\": \"months\",\n  \"day_of_month\": 1\n}\n\n// Every 45 days (custom interval)\n{\n  \"interval\": 45,\n  \"unit\": \"days\"\n}\n\n// Annually on January 1st (yearly subscription)\n{\n  \"interval\": 1,\n  \"unit\": \"years\",\n  \"day_of_month\": 1,\n  \"month_of_year\": 1\n}\n\n// Every 3 weeks on Wednesday\n{\n  \"interval\": 3,\n  \"unit\": \"weeks\",\n  \"day_of_week\": 3\n}\n</code></pre></p> <p>Calculation Logic: 1. Start from reference date 2. Calculate interval based on unit:    - <code>days</code>: Add/subtract <code>interval</code> days    - <code>weeks</code>: Add/subtract <code>interval * 7</code> days, optionally align to <code>day_of_week</code>    - <code>months</code>: Add/subtract <code>interval</code> months, use <code>day_of_month</code> if specified    - <code>years</code>: Add/subtract <code>interval</code> years, use <code>month_of_year</code> and <code>day_of_month</code> if specified 3. Generate all occurrences that fall within cycle period</p>"},{"location":"architecture/database-schema/#implementation-examples","title":"Implementation Examples","text":""},{"location":"architecture/database-schema/#python-calculation-functions","title":"Python Calculation Functions","text":"<pre><code>from datetime import date, timedelta\nfrom dateutil.relativedelta import relativedelta\nfrom typing import List, Dict, Any\n\ndef calculate_occurrences(\n    recurrence_type: str,\n    recurrence_config: Dict[str, Any],\n    reference_date: date,\n    cycle_start: date,\n    cycle_end: date\n) -&gt; List[date]:\n    \"\"\"Calculate expense occurrences within a cycle period.\"\"\"\n\n    if recurrence_type == \"weekly\":\n        return calculate_weekly_occurrences(\n            recurrence_config, reference_date, cycle_start, cycle_end\n        )\n    elif recurrence_type == \"bi_weekly\":\n        return calculate_bi_weekly_occurrences(\n            recurrence_config, reference_date, cycle_start, cycle_end\n        )\n    elif recurrence_type == \"monthly\":\n        return calculate_monthly_occurrences(\n            recurrence_config, reference_date, cycle_start, cycle_end\n        )\n    elif recurrence_type == \"custom\":\n        return calculate_custom_occurrences(\n            recurrence_config, reference_date, cycle_start, cycle_end\n        )\n    else:\n        raise ValueError(f\"Unknown recurrence type: {recurrence_type}\")\n\ndef calculate_weekly_occurrences(\n    config: Dict[str, Any],\n    reference_date: date,\n    cycle_start: date,\n    cycle_end: date\n) -&gt; List[date]:\n    \"\"\"Calculate weekly occurrences.\"\"\"\n    day_of_week = config[\"day_of_week\"]\n    occurrences = []\n\n    # Find first occurrence in or after cycle start\n    current_date = cycle_start\n    days_ahead = (day_of_week - current_date.weekday()) % 7\n    current_date += timedelta(days=days_ahead)\n\n    # Generate weekly occurrences\n    while current_date &lt;= cycle_end:\n        occurrences.append(current_date)\n        current_date += timedelta(days=7)\n\n    return occurrences\n\ndef calculate_bi_weekly_occurrences(\n    config: Dict[str, Any],\n    reference_date: date,\n    cycle_start: date,\n    cycle_end: date\n) -&gt; List[date]:\n    \"\"\"Calculate bi-weekly occurrences.\"\"\"\n    interval = config[\"interval_days\"]\n    occurrences = []\n\n    # Start from reference date and work backwards/forwards\n    current_date = reference_date\n\n    # Go backwards to find start point\n    while current_date &gt; cycle_start:\n        current_date -= timedelta(days=interval)\n\n    # Go forward to find all occurrences in cycle\n    while current_date &lt;= cycle_end:\n        if cycle_start &lt;= current_date &lt;= cycle_end:\n            occurrences.append(current_date)\n        current_date += timedelta(days=interval)\n\n    return occurrences\n\ndef calculate_monthly_occurrences(\n    config: Dict[str, Any],\n    reference_date: date,\n    cycle_start: date,\n    cycle_end: date\n) -&gt; List[date]:\n    \"\"\"Calculate monthly occurrences.\"\"\"\n    day_of_month = config[\"day_of_month\"]\n    handle_month_end = config.get(\"handle_month_end\", False)\n    occurrences = []\n\n    # Start from first month that overlaps with cycle\n    current_month = cycle_start.replace(day=1)\n\n    while current_month &lt;= cycle_end:\n        try:\n            occurrence_date = current_month.replace(day=day_of_month)\n        except ValueError:\n            # Handle months with fewer days\n            if handle_month_end:\n                # Use last day of month\n                next_month = current_month + relativedelta(months=1)\n                occurrence_date = next_month - timedelta(days=1)\n            else:\n                # Skip this month\n                current_month += relativedelta(months=1)\n                continue\n\n        # Check if occurrence falls within cycle\n        if cycle_start &lt;= occurrence_date &lt;= cycle_end:\n            occurrences.append(occurrence_date)\n\n        current_month += relativedelta(months=1)\n\n    return occurrences\n\ndef calculate_custom_occurrences(\n    config: Dict[str, Any],\n    reference_date: date,\n    cycle_start: date,\n    cycle_end: date\n) -&gt; List[date]:\n    \"\"\"Calculate custom interval occurrences.\"\"\"\n    interval = config[\"interval\"]\n    unit = config[\"unit\"]\n    occurrences = []\n\n    current_date = reference_date\n\n    # Go backwards to find start point\n    while current_date &gt; cycle_start:\n        if unit == \"days\":\n            current_date -= timedelta(days=interval)\n        elif unit == \"weeks\":\n            current_date -= timedelta(weeks=interval)\n        elif unit == \"months\":\n            current_date -= relativedelta(months=interval)\n        elif unit == \"years\":\n            current_date -= relativedelta(years=interval)\n\n    # Go forward to find all occurrences in cycle\n    while current_date &lt;= cycle_end:\n        if cycle_start &lt;= current_date &lt;= cycle_end:\n            occurrences.append(current_date)\n\n        # Move to next occurrence\n        if unit == \"days\":\n            current_date += timedelta(days=interval)\n        elif unit == \"weeks\":\n            current_date += timedelta(weeks=interval)\n        elif unit == \"months\":\n            current_date += relativedelta(months=interval)\n        elif unit == \"years\":\n            current_date += relativedelta(years=interval)\n\n    return occurrences\n</code></pre>"},{"location":"architecture/database-schema/#validation-schema","title":"Validation Schema","text":"<pre><code>from pydantic import BaseModel, validator\nfrom typing import Optional, Literal\n\nclass WeeklyConfig(BaseModel):\n    day_of_week: int\n\n    @validator('day_of_week')\n    def validate_day_of_week(cls, v):\n        if not 0 &lt;= v &lt;= 6:\n            raise ValueError('day_of_week must be between 0 and 6')\n        return v\n\nclass BiWeeklyConfig(BaseModel):\n    interval_days: int\n\n    @validator('interval_days')\n    def validate_interval_days(cls, v):\n        if v &lt;= 0:\n            raise ValueError('interval_days must be positive')\n        return v\n\nclass MonthlyConfig(BaseModel):\n    day_of_month: int\n    handle_month_end: Optional[bool] = False\n\n    @validator('day_of_month')\n    def validate_day_of_month(cls, v):\n        if not 1 &lt;= v &lt;= 31:\n            raise ValueError('day_of_month must be between 1 and 31')\n        return v\n\nclass CustomConfig(BaseModel):\n    interval: int\n    unit: Literal[\"days\", \"weeks\", \"months\", \"years\"]\n    day_of_month: Optional[int] = None\n    month_of_year: Optional[int] = None\n    day_of_week: Optional[int] = None\n\n    @validator('interval')\n    def validate_interval(cls, v):\n        if v &lt;= 0:\n            raise ValueError('interval must be positive')\n        return v\n\n    @validator('day_of_month')\n    def validate_day_of_month(cls, v):\n        if v is not None and not 1 &lt;= v &lt;= 31:\n            raise ValueError('day_of_month must be between 1 and 31')\n        return v\n\n    @validator('month_of_year')\n    def validate_month_of_year(cls, v):\n        if v is not None and not 1 &lt;= v &lt;= 12:\n            raise ValueError('month_of_year must be between 1 and 12')\n        return v\n\n    @validator('day_of_week')\n    def validate_day_of_week(cls, v):\n        if v is not None and not 0 &lt;= v &lt;= 6:\n            raise ValueError('day_of_week must be between 0 and 6')\n        return v\n</code></pre>"},{"location":"architecture/database-schema/#key-design-decisions","title":"Key Design Decisions","text":""},{"location":"architecture/database-schema/#1-multi-currency-support","title":"1. Multi-Currency Support","text":"<ul> <li>Native currency storage on each expense</li> <li>Automatic USD conversion for reporting</li> <li>Historical exchange rate tracking</li> </ul>"},{"location":"architecture/database-schema/#2-soft-deletes","title":"2. Soft Deletes","text":"<ul> <li><code>active</code> flags instead of hard deletes</li> <li>Preserves financial audit trails</li> <li>Maintains referential integrity</li> </ul>"},{"location":"architecture/database-schema/#3-jsonb-for-configuration","title":"3. JSONB for Configuration","text":"<ul> <li>Flexible recurrence pattern storage</li> <li>PostgreSQL's JSONB provides indexing and querying</li> <li>Schema evolution without migrations</li> </ul>"},{"location":"architecture/database-schema/#4-temporal-data","title":"4. Temporal Data","text":"<ul> <li>Created/updated timestamps on all tables</li> <li><code>paid_at</code> timestamp for expense tracking</li> <li>Date-based cycle management</li> </ul>"},{"location":"architecture/database-schema/#5-constraints-and-validation","title":"5. Constraints and Validation","text":"<ul> <li>Check constraints for positive amounts</li> <li>Unique constraints for business rules</li> <li>Foreign key cascades for data cleanup</li> </ul>"},{"location":"architecture/database-schema/#sample-queries","title":"Sample Queries","text":""},{"location":"architecture/database-schema/#generate-cycle-summary","title":"Generate Cycle Summary","text":"<pre><code>SELECT\n    c.name,\n    c.income_amount,\n    COUNT(ce.id) as total_expenses,\n    SUM(ce.amount_usd) as total_amount_usd,\n    SUM(CASE WHEN ce.category = 'fixed' THEN ce.amount_usd ELSE 0 END) as fixed_expenses,\n    SUM(CASE WHEN ce.category = 'variable' THEN ce.amount_usd ELSE 0 END) as variable_expenses,\n    c.income_amount - SUM(ce.amount_usd) as net_balance\nFROM cycles c\nLEFT JOIN cycle_expenses ce ON c.id = ce.cycle_id\nWHERE c.user_id = $1 AND c.id = $2\nGROUP BY c.id, c.name, c.income_amount;\n</code></pre>"},{"location":"architecture/database-schema/#payment-method-summary","title":"Payment Method Summary","text":"<pre><code>SELECT\n    pm.name,\n    pm.method_type,\n    COUNT(ce.id) as expense_count,\n    SUM(ce.amount_usd) as total_amount,\n    SUM(CASE WHEN ce.paid THEN ce.amount_usd ELSE 0 END) as paid_amount,\n    SUM(CASE WHEN NOT ce.paid THEN ce.amount_usd ELSE 0 END) as pending_amount\nFROM payment_methods pm\nLEFT JOIN cycle_expenses ce ON pm.id = ce.payment_method_id\nWHERE pm.user_id = $1 AND ce.cycle_id = $2\nGROUP BY pm.id, pm.name, pm.method_type\nORDER BY total_amount DESC;\n</code></pre> <p>This schema provides the foundation for all the functional requirements while maintaining data integrity and supporting complex financial reporting.</p>"},{"location":"architecture/deployment/","title":"Deployment Guide","text":"<p>This guide covers how Colony's components are deployed to various environments.</p>"},{"location":"architecture/deployment/#documentation-deployment","title":"Documentation Deployment","text":"<p>Colony's documentation is automatically deployed to GitHub Pages using GitHub Actions.</p>"},{"location":"architecture/deployment/#github-pages-setup","title":"GitHub Pages Setup","text":"<p>The documentation is built with MkDocs Material and deployed to GitHub Pages at: <code>https://your-username.github.io/colony/</code></p>"},{"location":"architecture/deployment/#automatic-deployment","title":"Automatic Deployment","text":"<p>Every push to the <code>main</code> branch automatically triggers a documentation build and deployment via GitHub Actions.</p>"},{"location":"architecture/deployment/#github-actions-workflow","title":"GitHub Actions Workflow","text":"<p>The deployment is handled by <code>.github/workflows/docs.yml</code>:</p> <pre><code>name: Deploy Documentation\non:\n  push:\n    branches: [ main ]\n  pull_request:\n    branches: [ main ]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n\n      - name: Configure Git Credentials\n        run: |\n          git config user.name github-actions[bot]\n          git config user.email 41898282+github-actions[bot]@users.noreply.github.com\n\n      - uses: actions/setup-python@v4\n        with:\n          python-version: 3.x\n\n      - name: Cache dependencies\n        uses: actions/cache@v3\n        with:\n          key: ${{ github.ref }}\n          path: .cache\n\n      - name: Install dependencies\n        run: pip install mkdocs-material\n\n      - name: Deploy to GitHub Pages\n        run: mkdocs gh-deploy --force\n</code></pre>"},{"location":"architecture/deployment/#manual-deployment","title":"Manual Deployment","text":"<p>To deploy documentation manually:</p> <pre><code># Install dependencies\npip install mkdocs-material\n\n# Deploy to GitHub Pages\nmkdocs gh-deploy\n</code></pre>"},{"location":"architecture/deployment/#repository-settings","title":"Repository Settings","text":"<p>Ensure your GitHub repository has the following settings:</p> <ol> <li>Go to Settings &gt; Pages</li> <li>Source: Deploy from a branch</li> <li>Branch: <code>gh-pages</code></li> <li>Folder: <code>/ (root)</code></li> </ol> <p>The <code>gh-deploy</code> command automatically creates and manages the <code>gh-pages</code> branch.</p>"},{"location":"architecture/deployment/#local-preview","title":"Local Preview","text":"<p>To preview documentation locally before deployment:</p> <pre><code># Install dependencies\npip install mkdocs-material\n\n# Serve locally\nmkdocs serve\n\n# Access at http://localhost:8000\n</code></pre>"},{"location":"architecture/deployment/#troubleshooting","title":"Troubleshooting","text":"<p>Common Issues:</p> <ul> <li>Permission denied: Ensure GitHub Actions has write permissions</li> <li>Build fails: Check that all referenced files exist in the docs folder</li> <li>Pages not updating: GitHub Pages can take a few minutes to reflect changes</li> </ul> <p>Debug Steps:</p> <ol> <li>Check GitHub Actions logs in the Actions tab</li> <li>Verify all documentation files are committed</li> <li>Ensure <code>mkdocs.yml</code> configuration is valid</li> <li>Test build locally with <code>mkdocs build</code></li> </ol>"},{"location":"architecture/deployment/#application-deployment","title":"Application Deployment","text":""},{"location":"architecture/deployment/#backend-deployment","title":"Backend Deployment","text":"<p>Coming soon - Docker containerization and deployment strategies</p>"},{"location":"architecture/deployment/#frontend-deployment","title":"Frontend Deployment","text":"<p>Coming soon - Static site deployment options</p>"},{"location":"architecture/deployment/#full-stack-deployment","title":"Full Stack Deployment","text":"<p>Coming soon - Complete deployment with Docker Compose</p>"},{"location":"development/","title":"Development Guide","text":"<p>Welcome to the Colony development guide. This section contains all the information you need to contribute to or modify the Colony project.</p>"},{"location":"development/#project-structure","title":"Project Structure","text":"<pre><code>colony/\n\u251c\u2500\u2500 backend/          # FastAPI application\n\u2502   \u251c\u2500\u2500 app/\n\u2502   \u251c\u2500\u2500 requirements.txt\n\u2502   \u2514\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 frontend/         # Next.js application\n\u2502   \u251c\u2500\u2500 src/\n\u2502   \u251c\u2500\u2500 package.json\n\u2502   \u2514\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 shared/           # Shared types, constants\n\u251c\u2500\u2500 docs/            # Documentation\n\u251c\u2500\u2500 .github/         # GitHub Actions workflows\n\u251c\u2500\u2500 docker-compose.yml\n\u2514\u2500\u2500 README.md\n</code></pre>"},{"location":"development/#development-philosophy","title":"Development Philosophy","text":"<p>This project serves multiple purposes:</p> <ul> <li>Personal Finance Management: Create a robust tool for tracking personal expenses</li> <li>Technology Practice: Explore modern web development technologies</li> <li>Learning Experience: Implement best practices in full-stack development</li> </ul>"},{"location":"development/#prerequisites-for-development","title":"Prerequisites for Development","text":"<ul> <li>Docker and Docker Compose (required)</li> <li>Node.js 18+ (for local frontend development)</li> <li>Python 3.11+ (for local backend development)</li> <li>Git (version control)</li> </ul>"},{"location":"development/#development-workflow","title":"Development Workflow","text":"<ol> <li> <p>Fork and Clone <pre><code>git clone https://github.com/jcarranz97/colony.git\ncd colony\n</code></pre></p> </li> <li> <p>Create Feature Branch <pre><code>git checkout -b feature/your-feature-name\n</code></pre></p> </li> <li> <p>Make Changes</p> </li> <li>Follow coding standards</li> <li>Write tests for new features</li> <li> <p>Update documentation</p> </li> <li> <p>Test Locally <pre><code>docker-compose up --build\n</code></pre></p> </li> <li> <p>Submit Pull Request</p> </li> <li>Ensure all tests pass</li> <li>Include clear description</li> <li>Reference any related issues</li> </ol>"},{"location":"development/#next-steps","title":"Next Steps","text":"<ul> <li>Local Setup - Set up your development environment</li> <li>Code Quality - Code standards and pre-commit hooks</li> <li>Testing - Learn about our testing approach</li> <li>Deployment - Understand deployment processes (including docs)</li> <li>Architecture - Dive into system design</li> </ul>"},{"location":"development/code-quality/","title":"Code Quality &amp; Standards","text":"<p>Colony maintains high code quality through automated linting, formatting, and pre-commit hooks.</p>"},{"location":"development/code-quality/#pre-commit-hooks","title":"Pre-commit Hooks","text":"<p>We use pre-commit to automatically check code quality before commits.</p>"},{"location":"development/code-quality/#installation","title":"Installation","text":"<pre><code># Install pre-commit\npip install pre-commit\n\n# Install the git hook scripts\ncd colony\npre-commit install\n</code></pre>"},{"location":"development/code-quality/#what-gets-checked","title":"What Gets Checked","text":"<p>Our pre-commit configuration includes:</p>"},{"location":"development/code-quality/#general-checks-all-files","title":"General Checks (All Files)","text":"<ul> <li>Trailing whitespace removal</li> <li>End-of-file fixer (ensures files end with newline)</li> <li>YAML syntax validation</li> <li>Large file detection (prevents accidental commits of large files)</li> <li>Case conflict detection</li> <li>Merge conflict markers</li> <li>JSON/TOML syntax validation</li> </ul>"},{"location":"development/code-quality/#python-backend","title":"Python (Backend)","text":"<ul> <li>Ruff - Fast linting and code formatting (replaces Black, isort, and flake8)</li> </ul>"},{"location":"development/code-quality/#javascripttypescript-frontend","title":"JavaScript/TypeScript (Frontend)","text":"<ul> <li>Prettier - Code formatting for JS, TS, JSON, CSS, and Markdown</li> </ul>"},{"location":"development/code-quality/#docker","title":"Docker","text":"<ul> <li>Hadolint - Dockerfile linting</li> </ul>"},{"location":"development/code-quality/#markdown","title":"Markdown","text":"<ul> <li>markdownlint - Markdown formatting and style</li> </ul>"},{"location":"development/code-quality/#usage","title":"Usage","text":"<p>Pre-commit hooks run automatically on <code>git commit</code>. You can also run them manually:</p> <pre><code># Run on all files\npre-commit run --all-files\n\n# Run on staged files only\npre-commit run\n</code></pre>"},{"location":"development/code-quality/#manual-python-code-quality","title":"Manual Python Code Quality","text":"<p>You can also run ruff manually for development:</p> <pre><code>cd backend\n\n# Check and auto-fix linting issues\nuv run ruff check . --fix\n\n# Format code\nuv run ruff format .\n\n# Run both checks\nuv run ruff format . &amp;&amp; uv run ruff check . --fix\n</code></pre>"},{"location":"development/code-quality/#bypassing-hooks","title":"Bypassing Hooks","text":"<p>In rare cases, you might need to bypass hooks:</p> <pre><code># Bypass all hooks\ngit commit -m \"your message\" --no-verify\n\n# Not recommended - only use when absolutely necessary\n</code></pre>"},{"location":"development/code-quality/#configuration-files","title":"Configuration Files","text":"<p>Pre-commit uses several configuration files:</p> <ul> <li><code>.pre-commit-config.yaml</code> - Main pre-commit configuration</li> <li><code>pyproject.toml</code> - Ruff configuration (linting and formatting rules)</li> <li><code>.prettierrc</code> (if needed) - JavaScript/TypeScript formatting</li> <li><code>.markdownlint.json</code> (if needed) - Markdown linting rules</li> </ul>"},{"location":"development/code-quality/#code-style-guidelines","title":"Code Style Guidelines","text":""},{"location":"development/code-quality/#python-backend_1","title":"Python (Backend)","text":"<p>We follow Python community standards using Ruff:</p> <ul> <li>PEP 8 style guide</li> <li>Ruff for automatic formatting and linting</li> <li>88 character line limit</li> <li>Type hints for function signatures</li> <li>Docstrings for classes and functions</li> </ul> <p>Example: <pre><code>def calculate_expense_total(expenses: List[Expense]) -&gt; Decimal:\n    \"\"\"Calculate the total amount from a list of expenses.\n\n    Args:\n        expenses: List of expense objects\n\n    Returns:\n        Total amount as Decimal\n    \"\"\"\n    return sum(expense.amount for expense in expenses)\n</code></pre></p>"},{"location":"development/code-quality/#javascripttypescript-frontend_1","title":"JavaScript/TypeScript (Frontend)","text":"<ul> <li>Prettier for consistent formatting</li> <li>ESLint rules (to be added)</li> <li>2-space indentation</li> <li>Semicolons required</li> <li>Single quotes preferred</li> </ul> <p>Example: <pre><code>interface ExpenseData {\n  id: string;\n  amount: number;\n  category: string;\n  date: Date;\n}\n\nconst formatCurrency = (amount: number): string =&gt; {\n  return new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency: 'USD',\n  }).format(amount);\n};\n</code></pre></p>"},{"location":"development/code-quality/#documentation","title":"Documentation","text":"<ul> <li>Markdown files should be properly formatted</li> <li>Code blocks must specify language</li> <li>Links should be descriptive</li> <li>Headers should follow hierarchy</li> </ul>"},{"location":"development/code-quality/#ide-configuration","title":"IDE Configuration","text":""},{"location":"development/code-quality/#vs-code","title":"VS Code","text":"<p>Recommended extensions and settings:</p> <pre><code>// .vscode/settings.json\n{\n  \"python.defaultInterpreterPath\": \"./backend/.venv/bin/python\",\n  \"editor.formatOnSave\": true,\n  \"editor.codeActionsOnSave\": {\n    \"source.organizeImports\": true\n  },\n  \"[python]\": {\n    \"editor.defaultFormatter\": \"charliermarsh.ruff\"\n  },\n  \"[typescript]\": {\n    \"editor.defaultFormatter\": \"esbenp.prettier-vscode\"\n  },\n  \"[javascript]\": {\n    \"editor.defaultFormatter\": \"esbenp.prettier-vscode\"\n  }\n}\n</code></pre>"},{"location":"development/code-quality/#recommended-extensions","title":"Recommended Extensions","text":"<p>Create <code>.vscode/extensions.json</code>: <pre><code>{\n  \"recommendations\": [\n    \"ms-python.python\",\n    \"charliermarsh.ruff\",\n    \"esbenp.prettier-vscode\",\n    \"bradlc.vscode-tailwindcss\",\n    \"ms-vscode.vscode-docker\",\n    \"davidanson.vscode-markdownlint\"\n  ]\n}\n</code></pre></p>"},{"location":"development/code-quality/#continuous-integration","title":"Continuous Integration","text":"<p>Pre-commit hooks also run in CI/CD to ensure code quality:</p> <pre><code># In .github/workflows/ci.yml (future)\n- name: Run pre-commit\n  uses: pre-commit/action@v3.0.0\n</code></pre>"},{"location":"development/code-quality/#troubleshooting","title":"Troubleshooting","text":""},{"location":"development/code-quality/#common-issues","title":"Common Issues","text":"<p>Pre-commit fails on existing files: <pre><code># Run on all files to fix existing issues\npre-commit run --all-files\n</code></pre></p> <p>Python formatting/linting issues: <pre><code># Make sure you're in the correct directory\ncd backend\n\n# Fix linting issues\nuv run ruff check . --fix\n\n# Format code\nuv run ruff format .\n</code></pre></p> <p>Node.js formatting issues: <pre><code>cd frontend\nnpx prettier --write src/\n</code></pre></p>"},{"location":"development/code-quality/#getting-help","title":"Getting Help","text":"<p>If you encounter issues with code quality tools:</p> <ol> <li>Check the tool's documentation</li> <li>Run the tool manually to see detailed error messages</li> <li>Ask in project discussions or issues</li> </ol>"},{"location":"development/setup/","title":"Local Development Setup","text":"<p>This guide walks you through setting up Colony for local development.</p>"},{"location":"development/setup/#prerequisites","title":"Prerequisites","text":"<ul> <li>Python 3.13+</li> <li>Node.js 18+</li> <li>Docker and Docker Compose</li> <li>Git</li> </ul>"},{"location":"development/setup/#initial-setup","title":"Initial Setup","text":"<pre><code># Clone the repository\ngit clone https://github.com/jcarranz97/colony.git\ncd colony\n\n# Install pre-commit hooks\npip install pre-commit\npre-commit install\n</code></pre>"},{"location":"development/setup/#option-1-docker-development-recommended","title":"Option 1: Docker Development (Recommended)","text":"<p>The easiest way to get started is using Docker Compose:</p> <pre><code># Start all services\ndocker-compose up --build\n\n# Or run in detached mode\ndocker-compose up -d --build\n</code></pre>"},{"location":"development/setup/#services-available","title":"Services Available","text":"<ul> <li>Frontend: http://localhost:3000</li> <li>Backend API: http://localhost:8000</li> <li>API Documentation: http://localhost:8000/docs</li> <li>ReDoc: http://localhost:8000/redoc</li> </ul>"},{"location":"development/setup/#option-2-local-development","title":"Option 2: Local Development","text":"<p>For development with hot reloading:</p>"},{"location":"development/setup/#backend-setup","title":"Backend Setup","text":"<pre><code>cd backend\n\n# Install dependencies using uv\nuv sync\n\n# Run development server\nuv run fastapi dev\n\n# For linting and formatting\nuv run ruff check . --fix    # Lint and auto-fix issues\nuv run ruff format .         # Format code\n\n# Type checking\nuv run pyright .\n\n# Run tests\nuv run pytest\n</code></pre>"},{"location":"development/setup/#managing-dependencies","title":"Managing Dependencies","text":""},{"location":"development/setup/#adding-dependencies","title":"Adding Dependencies","text":"<p>We use uv for Python package management:</p> <pre><code>cd backend\n\n# Add a production dependency\nuv add fastapi\n\n# Add a development dependency\nuv add pytest --dev\nuv add ruff --dev\n\n# Add a dependency with version constraints\nuv add \"fastapi&gt;=0.100.0\"\n\n# Add from a specific index or source\nuv add requests --index-url https://pypi.org/simple/\n</code></pre>"},{"location":"development/setup/#removing-dependencies","title":"Removing Dependencies","text":"<pre><code># Remove a dependency\nuv remove package-name\n\n# Remove a dev dependency\nuv remove package-name --dev\n</code></pre>"},{"location":"development/setup/#updating-dependencies","title":"Updating Dependencies","text":"<pre><code># Update all dependencies\nuv sync --upgrade\n\n# Update a specific package\nuv add package-name --upgrade\n\n# See outdated packages\nuv tree --outdated\n</code></pre>"},{"location":"development/setup/#installing-dependencies","title":"Installing Dependencies","text":"<pre><code># Install all dependencies (production + dev)\nuv sync\n\n# Install only production dependencies\nuv sync --no-dev\n\n# Install and update lock file\nuv sync --upgrade\n</code></pre>"},{"location":"development/setup/#frontend-setup","title":"Frontend Setup","text":"<pre><code>cd frontend\n\n# Install dependencies\nnpm install\n\n# Install development dependencies\nnpm install --save-dev prettier eslint\n\n# Run development server\nnpm run dev\n</code></pre>"},{"location":"development/setup/#documentation-setup","title":"Documentation Setup","text":"<pre><code>cd docs\n\n# Install MkDocs Material\npip install mkdocs-material\n\n# Serve documentation\nmkdocs serve\n</code></pre>"},{"location":"development/setup/#code-quality-setup","title":"Code Quality Setup","text":"<pre><code># Install pre-commit (if not already done)\npip install pre-commit\n\n# Install git hooks\npre-commit install\n\n# Run on all files (first time)\npre-commit run --all-files\n</code></pre>"},{"location":"development/setup/#environment-variables","title":"Environment Variables","text":"<p>Create a <code>.env</code> file in the root directory:</p> <pre><code># Database\nDATABASE_URL=sqlite:///./colony.db\n\n# Security\nSECRET_KEY=your-secret-key-here\nALGORITHM=HS256\nACCESS_TOKEN_EXPIRE_MINUTES=30\n\n# Development\nDEBUG=true\n</code></pre>"},{"location":"development/setup/#development-workflow","title":"Development Workflow","text":"<ol> <li>Make changes to your code</li> <li>Add dependencies if needed using <code>uv add</code></li> <li>Pre-commit hooks will automatically run on commit</li> <li>Test locally using Docker Compose or individual services</li> <li>Submit pull request when ready</li> </ol>"},{"location":"development/setup/#next-steps","title":"Next Steps","text":"<ul> <li>Code Quality - Learn about our code standards and pre-commit hooks</li> <li>Testing - Understand our testing approach</li> <li>Architecture - Explore the system design</li> </ul>"}]}